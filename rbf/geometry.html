<!DOCTYPE html>
<!-- Generated by Cython 0.28.3 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: geometry.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.28.3</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="geometry.c">geometry.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: <span class="sd">Module of cythonized functions for basic computational geometry in 1, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: <span class="sd">2, and 3 dimensions. This modules requires all geometric objects (e.g. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="sd">volumes, polygons, surfaces, segments, etc.) to be described as </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: <span class="sd">simplicial complexes. A simplicial complex is a collection of </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: <span class="sd">simplices (e.g. segments, triangles, tetrahedra, etc.).  In this </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: <span class="sd">module, simplicial complexes in D-dimenional space are described with </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: <span class="sd">an (N,D) array of vertices and and (M,D) array describing the indices </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: <span class="sd">of vertices making up each simplex. As an example, the unit square in </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0010</span>: <span class="sd">two dimensions can be described as collection of line segments:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: <span class="sd">&gt;&gt;&gt; vertices = [[0.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>: <span class="sd">                [1.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0014</span>: <span class="sd">                [1.0,1.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0015</span>: <span class="sd">                [0.0,1.0]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0016</span>: <span class="sd">&gt;&gt;&gt; simplices = [[0,1],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>: <span class="sd">                 [1,2],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0018</span>: <span class="sd">                 [2,3],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>: <span class="sd">                 [3,0]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>: <span class="sd">A three dimensional cube can similarly be described as a collection</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>: <span class="sd">of triangles:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>: <span class="sd">&gt;&gt;&gt; vertices = [[0.0,0.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>: <span class="sd">                [0.0,0.0,1.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>: <span class="sd">                [0.0,1.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: <span class="sd">                [0.0,1.0,1.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>: <span class="sd">                [1.0,0.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0029</span>: <span class="sd">                [1.0,0.0,1.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: <span class="sd">                [1.0,1.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>: <span class="sd">                [1.0,1.0,1.0]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>: <span class="sd">&gt;&gt;&gt; simplices = [[0,1,4],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>: <span class="sd">                 [1,5,4],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: <span class="sd">                 [1,7,5],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>: <span class="sd">                 [1,3,7],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>: <span class="sd">                 [0,1,3],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>: <span class="sd">                 [0,2,3],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>: <span class="sd">                 [0,2,6],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>: <span class="sd">                 [0,4,6],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>: <span class="sd">                 [4,5,7],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>: <span class="sd">                 [4,6,7],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: <span class="sd">                 [2,3,7],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>: <span class="sd">                 [2,6,7]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>: <span class="sd"> </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: <span class="sd">Although the notation is clumsy, a 1D domains can be described as a </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="sd">collection of vertices in a manner that is consistent with the above </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>: <span class="sd">two examples:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>: <span class="sd">   </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: <span class="sd">&gt;&gt;&gt; vertices = [[0.0],[1.0]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: <span class="sd">&gt;&gt;&gt; simplices = [[0],[1]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: <span class="sd">This module is primarily use to find whether and where line segments </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: <span class="sd">intersect a simplicial complex and whether points are contained within </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: <span class="sd">a closed simplicial complex.  For example, one can determine whether a </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>: <span class="sd">collection of points, saved as `points`, are contained within a </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0056</span>: <span class="sd">simplicial complex, defined by `vertices` and `simplices` with the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>: <span class="sd">command</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0058</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>: <span class="sd">&gt;&gt;&gt; contains(points,vertices,simplices)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0060</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0061</span>: <span class="sd">which returns a boolean array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0063</span>: <span class="sd">One can find the number of times a collection of line segments, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: <span class="sd">defined by `start_points` and `end_points`, intersect a simplicial </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0065</span>: <span class="sd">complex with the command</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>: <span class="sd">&gt;&gt; intersection_count(start_points,end_points,vertices,simplices)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>: <span class="sd">which returns an array of the number of simplexes intersections for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>: <span class="sd">each segment. If it is known that a collection of line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>: <span class="sd">intersect a simplicial complex then the intersection point can be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>: <span class="sd">found with the command</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0073</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>: <span class="sd">&gt;&gt; intersection_point(start_points,end_points,vertices,simplices)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0075</span>: <span class="sd"> </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0076</span>: <span class="sd">This returns an (N,D) array of intersection points where N is the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>: <span class="sd">number of line segments.  If a line segment does not intersect the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0078</span>: <span class="sd">simplicial complex then the above command returns a ValueError. If </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0079</span>: <span class="sd">there are multiple intersections for a single segment then only the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0080</span>: <span class="sd">first detected intersection will be returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>: <span class="sd">There are numerous other packages which can perform the same tasks </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0083</span>: <span class="sd">as this module.  For example geos (http://trac.osgeo.org/geos/) and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0084</span>: <span class="sd">gts (http://gts.sourceforge.net/).  However, the python bindings for </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>: <span class="sd">these packages are too slow for RBF purposes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>: <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0087</span>: <span class="c"># python imports</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0088</span>: <span class="k">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0089</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0090</span>: <span class="k">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">combinations</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_combinations);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_combinations);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_combinations);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_itertools, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_combinations);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_combinations, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0091</span>: <span class="k">from</span> <span class="nn">scipy.special</span> <span class="k">import</span> <span class="n">factorial</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_factorial);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_factorial);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_factorial);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_special, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_factorial);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_factorial, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0092</span>: <span class="c"># cython imports</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0093</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0094</span>: <span class="k">from</span> <span class="nn">cython</span> <span class="k">cimport</span> <span class="n">boundscheck</span><span class="p">,</span><span class="n">wraparound</span><span class="p">,</span><span class="n">cdivision</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0095</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">malloc</span><span class="p">,</span><span class="n">free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">rand</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0099</span>: <span class="c"># NOTE: fabs is not the same as abs in C!!! </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0100</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;math.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0101</span>:   <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">fabs</span><span class="p">(</span><span class="nb">float</span> <span class="n">x</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0102</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0103</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;math.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0104</span>:   <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">sqrt</span><span class="p">(</span><span class="nb">float</span> <span class="n">x</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0105</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0106</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;limits.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0107</span>:     <span class="nb">int</span> <span class="n">RAND_MAX</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0108</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0109</span>: <span class="c">## geometric data types</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0110</span>: <span class="c">#####################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0111</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0112</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">vector1d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_vector1d {
  double x;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0113</span>:   <span class="n">double</span> <span class="n">x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0114</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0115</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">vector2d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_vector2d {
  double x;
  double y;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0116</span>:   <span class="n">double</span> <span class="n">x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>:   <span class="n">double</span> <span class="n">y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0118</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0119</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">vector3d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_vector3d {
  double x;
  double y;
  double z;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0120</span>:   <span class="n">double</span> <span class="n">x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0121</span>:   <span class="n">double</span> <span class="n">y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0122</span>:   <span class="n">double</span> <span class="n">z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0123</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0124</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">segment1d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_segment1d {
  struct __pyx_t_3rbf_8geometry_vector1d a;
  struct __pyx_t_3rbf_8geometry_vector1d b;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0125</span>:   <span class="n">vector1d</span> <span class="n">a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0126</span>:   <span class="n">vector1d</span> <span class="n">b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0128</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">segment2d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_segment2d {
  struct __pyx_t_3rbf_8geometry_vector2d a;
  struct __pyx_t_3rbf_8geometry_vector2d b;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0129</span>:   <span class="n">vector2d</span> <span class="n">a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>:   <span class="n">vector2d</span> <span class="n">b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0132</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">segment3d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_segment3d {
  struct __pyx_t_3rbf_8geometry_vector3d a;
  struct __pyx_t_3rbf_8geometry_vector3d b;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0133</span>:   <span class="n">vector3d</span> <span class="n">a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>:   <span class="n">vector3d</span> <span class="n">b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0135</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0136</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">triangle2d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_triangle2d {
  struct __pyx_t_3rbf_8geometry_vector2d a;
  struct __pyx_t_3rbf_8geometry_vector2d b;
  struct __pyx_t_3rbf_8geometry_vector2d c;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0137</span>:   <span class="n">vector2d</span> <span class="n">a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0138</span>:   <span class="n">vector2d</span> <span class="n">b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0139</span>:   <span class="n">vector2d</span> <span class="n">c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0141</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">triangle3d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_triangle3d {
  struct __pyx_t_3rbf_8geometry_vector3d a;
  struct __pyx_t_3rbf_8geometry_vector3d b;
  struct __pyx_t_3rbf_8geometry_vector3d c;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0142</span>:   <span class="n">vector3d</span> <span class="n">a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0143</span>:   <span class="n">vector3d</span> <span class="n">b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0144</span>:   <span class="n">vector3d</span> <span class="n">c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0145</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0146</span>: <span class="k">cdef</span> <span class="kt">segment2d</span>* <span class="nf">allocate_segment2d_array</span><span class="p">(</span><span class="nb">long</span> <span class="n">n</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_segment2d *__pyx_f_3rbf_8geometry_allocate_segment2d_array(long __pyx_v_n) {
  struct __pyx_t_3rbf_8geometry_segment2d *__pyx_v_out;
  struct __pyx_t_3rbf_8geometry_segment2d *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("allocate_segment2d_array", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("rbf.geometry.allocate_segment2d_array", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0147</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>: <span class="sd">  This is used in `contains_2d` and `intersection_count_2d`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0151</span>:     <span class="n">segment2d</span><span class="o">*</span> <span class="n">out</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment2d</span><span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment2d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out = ((struct __pyx_t_3rbf_8geometry_segment2d *)malloc((__pyx_v_n * (sizeof(struct __pyx_t_3rbf_8geometry_segment2d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0152</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0153</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">out</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((!(__pyx_v_out != 0)) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0154</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>__PYX_ERR(0, 154, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0155</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0156</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0157</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0158</span>: <span class="k">cdef</span> <span class="kt">segment3d</span>* <span class="nf">allocate_segment3d_array</span><span class="p">(</span><span class="nb">long</span> <span class="n">n</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_segment3d *__pyx_f_3rbf_8geometry_allocate_segment3d_array(long __pyx_v_n) {
  struct __pyx_t_3rbf_8geometry_segment3d *__pyx_v_out;
  struct __pyx_t_3rbf_8geometry_segment3d *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("allocate_segment3d_array", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("rbf.geometry.allocate_segment3d_array", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0159</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0160</span>: <span class="sd">  This is used in `contains_3d` and `intersection_count_3d`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0161</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0163</span>:     <span class="n">segment3d</span><span class="o">*</span> <span class="n">out</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment3d</span><span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment3d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out = ((struct __pyx_t_3rbf_8geometry_segment3d *)malloc((__pyx_v_n * (sizeof(struct __pyx_t_3rbf_8geometry_segment3d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0164</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0165</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">out</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((!(__pyx_v_out != 0)) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0166</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>__PYX_ERR(0, 166, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0167</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0169</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>: <span class="c">## point in simplex functions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>: <span class="c">#####################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0172</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0173</span>: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">point_in_segment</span><span class="p">(</span><span class="n">vector1d</span> <span class="n">vec</span><span class="p">,</span> <span class="n">segment1d</span> <span class="n">seg</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry_point_in_segment(struct __pyx_t_3rbf_8geometry_vector1d __pyx_v_vec, struct __pyx_t_3rbf_8geometry_segment1d __pyx_v_seg) {
  double __pyx_v_l1;
  double __pyx_v_l2;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0174</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0175</span>: <span class="sd">  Identifies whether a point in 1D space is within a 1D segment. For </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0176</span>: <span class="sd">  the sake of consistency, this is done by projecting the point into a </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0177</span>: <span class="sd">  barycentric coordinate system defined by the segment. The point is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0178</span>: <span class="sd">  then inside the segment if both of the barycentric coordinates are </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0179</span>: <span class="sd">  positive</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0180</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0181</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0182</span>:     <span class="n">double</span> <span class="n">l1</span><span class="p">,</span><span class="n">l2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0183</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0184</span>:   <span class="c"># find barycentric coordinates  </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0185</span>:   <span class="n">l1</span> <span class="o">=</span> <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_l1 = ((__pyx_v_seg.a.x - __pyx_v_vec.x) / (__pyx_v_seg.a.x - __pyx_v_seg.b.x));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0186</span>:   <span class="n">l2</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_l2 = ((__pyx_v_vec.x - __pyx_v_seg.b.x) / (__pyx_v_seg.a.x - __pyx_v_seg.b.x));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0187</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">l1</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">l2</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_l1 &gt;= 0.0) &amp; (__pyx_v_l2 &gt;= 0.0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:     <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0189</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0190</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0192</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0193</span>: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">point_in_triangle</span><span class="p">(</span><span class="n">vector2d</span> <span class="n">vec</span><span class="p">,</span> <span class="n">triangle2d</span> <span class="n">tri</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry_point_in_triangle(struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec, struct __pyx_t_3rbf_8geometry_triangle2d __pyx_v_tri) {
  double __pyx_v_det;
  double __pyx_v_l1;
  double __pyx_v_l2;
  double __pyx_v_l3;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0194</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0195</span>: <span class="sd">  Identifies whether a point in 2D space is within a 2D triangle. This </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0196</span>: <span class="sd">  is done by projecting the point into a barycentric coordinate system </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0197</span>: <span class="sd">  defined by the triangle. The point is then inside the segment if all </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0198</span>: <span class="sd">  three of the barycentric coordinates are positive</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0199</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0200</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0201</span>:     <span class="n">double</span> <span class="n">det</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">l3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0202</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0203</span>:   <span class="c"># find barycentric coordinates  </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0204</span>:   <span class="n">det</span> <span class="o">=</span>  <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_det = (((__pyx_v_tri.b.y - __pyx_v_tri.c.y) * (__pyx_v_tri.a.x - __pyx_v_tri.c.x)) + ((__pyx_v_tri.c.x - __pyx_v_tri.b.x) * (__pyx_v_tri.a.y - __pyx_v_tri.c.y)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0205</span>:   <span class="n">l1</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">det</span></pre>
<pre class='cython code score-0 '>  __pyx_v_l1 = ((((__pyx_v_tri.b.y - __pyx_v_tri.c.y) * (__pyx_v_vec.x - __pyx_v_tri.c.x)) + ((__pyx_v_tri.c.x - __pyx_v_tri.b.x) * (__pyx_v_vec.y - __pyx_v_tri.c.y))) / __pyx_v_det);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0206</span>:   <span class="n">l2</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">det</span></pre>
<pre class='cython code score-0 '>  __pyx_v_l2 = ((((__pyx_v_tri.c.y - __pyx_v_tri.a.y) * (__pyx_v_vec.x - __pyx_v_tri.c.x)) + ((__pyx_v_tri.a.x - __pyx_v_tri.c.x) * (__pyx_v_vec.y - __pyx_v_tri.c.y))) / __pyx_v_det);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0207</span>:   <span class="n">l3</span> <span class="o">=</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">l1</span> <span class="o">-</span> <span class="n">l2</span></pre>
<pre class='cython code score-0 '>  __pyx_v_l3 = ((1.0 - __pyx_v_l1) - __pyx_v_l2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0208</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">l1</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">l2</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">l3</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((((__pyx_v_l1 &gt;= 0.0) &amp; (__pyx_v_l2 &gt;= 0.0)) &amp; (__pyx_v_l3 &gt;= 0.0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0209</span>:     <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0210</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0211</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0213</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0214</span>: <span class="c">## simplex normals functions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>: <span class="c">#####################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0216</span>: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">segment_normal_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry_segment_normal_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg) {
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0217</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0218</span>: <span class="sd">  Returns the vector normal to a 2d line segment</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0219</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0220</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0221</span>:     <span class="n">vector2d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0222</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0223</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_seg.b.y - __pyx_v_seg.a.y);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (-(__pyx_v_seg.b.x - __pyx_v_seg.a.x));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0225</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0227</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0228</span>: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">triangle_normal_3d</span><span class="p">(</span><span class="n">triangle3d</span> <span class="n">tri</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry_triangle_normal_3d(struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri) {
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0229</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0230</span>: <span class="sd">  Returns the vector normal to a 3d triangle</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0231</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0232</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0233</span>:     <span class="n">vector3d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0235</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0236</span>:             <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0237</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (-(((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0238</span>:             <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0239</span>:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.z = (((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)) - ((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0240</span>:             <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0241</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0242</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0243</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0244</span>: <span class="c">## find point outside simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0245</span>: <span class="c">#####################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0246</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0247</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0248</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0249</span>: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">find_outside_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">v</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry_find_outside_2d(__Pyx_memviewslice __pyx_v_v) {
  unsigned int __pyx_v_i;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0250</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0251</span>: <span class="sd">  Finds a arbitrary point that is outside of a polygon defined by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0252</span>: <span class="sd">  the given vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0253</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0254</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0255</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0256</span>:     <span class="n">vector2d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0257</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0258</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_1 * __pyx_v_v.strides[0]) ) + __pyx_t_2 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0259</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 1;
  __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_3 * __pyx_v_v.strides[0]) ) + __pyx_t_4 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0260</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_v.shape[0]);
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 1; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0261</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">x</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_t_10 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_8 * __pyx_v_v.strides[0]) ) + __pyx_t_9 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.x) != 0);
    if (__pyx_t_10) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0262</span>:       <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = 0;
      __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_11 * __pyx_v_v.strides[0]) ) + __pyx_t_12 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0263</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0264</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">y</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 1;
    __pyx_t_10 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) ) + __pyx_t_14 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.y) != 0);
    if (__pyx_t_10) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0265</span>:       <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = 1;
      __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) ) + __pyx_t_16 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0266</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0267</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mf">1.23456789</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_out.x - 1.23456789);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0268</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="mf">2.34567891</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (__pyx_v_out.y - 2.34567891);
</pre><pre class="cython line score-0">&#xA0;<span class="">0269</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0270</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0271</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0272</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0273</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0274</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0275</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0276</span>: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">find_outside_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">v</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry_find_outside_3d(__Pyx_memviewslice __pyx_v_v) {
  unsigned int __pyx_v_i;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0277</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0278</span>: <span class="sd">  Finds a arbitrary point that is outside of a polyhedron defined by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0279</span>: <span class="sd">  the given vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0280</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0281</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0282</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0283</span>:     <span class="n">vector3d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0284</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0285</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_1 * __pyx_v_v.strides[0]) ) + __pyx_t_2 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0286</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 1;
  __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_3 * __pyx_v_v.strides[0]) ) + __pyx_t_4 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0287</span>:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = 0;
  __pyx_t_6 = 2;
  __pyx_v_out.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_5 * __pyx_v_v.strides[0]) ) + __pyx_t_6 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0288</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (__pyx_v_v.shape[0]);
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 1; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0289</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">x</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 0;
    __pyx_t_12 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_10 * __pyx_v_v.strides[0]) ) + __pyx_t_11 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.x) != 0);
    if (__pyx_t_12) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0290</span>:       <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = 0;
      __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) ) + __pyx_t_14 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0291</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0292</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">y</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_12 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) ) + __pyx_t_16 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.y) != 0);
    if (__pyx_t_12) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0293</span>:       <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_i;
      __pyx_t_18 = 1;
      __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) ) + __pyx_t_18 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0294</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0295</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">z</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 2;
    __pyx_t_12 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) ) + __pyx_t_20 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.z) != 0);
    if (__pyx_t_12) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:       <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_i;
      __pyx_t_22 = 2;
      __pyx_v_out.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_21 * __pyx_v_v.strides[0]) ) + __pyx_t_22 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0297</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0298</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mf">1.23456789</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_out.x - 1.23456789);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0299</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="mf">2.34567891</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (__pyx_v_out.y - 2.34567891);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">-=</span> <span class="mf">3.45678912</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.z = (__pyx_v_out.z - 3.45678912);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0301</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0302</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0303</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0304</span>: <span class="c">## 2D point in polygon functions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0305</span>: <span class="c">#####################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0306</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0307</span>: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_intersecting_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry_is_intersecting_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2) {
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_pnt;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector1d __pyx_v_pnt_proj;
  struct __pyx_t_3rbf_8geometry_segment1d __pyx_v_seg_proj;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0308</span>:                              <span class="n">segment2d</span> <span class="n">seg2</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0310</span>: <span class="sd">  Identifies whether two 2D segments intersect. An intersection is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0311</span>: <span class="sd">  detected if both segments are not colinear and if any part of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0312</span>: <span class="sd">  two segments touch</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0315</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0316</span>:     <span class="n">vector2d</span> <span class="n">pnt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0317</span>:     <span class="n">vector2d</span> <span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0318</span>:     <span class="n">vector1d</span> <span class="n">pnt_proj</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0319</span>:     <span class="n">segment1d</span> <span class="n">seg_proj</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0320</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0321</span>:   <span class="c"># find the normal vector components for segment 2</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0322</span>:   <span class="n">n</span> <span class="o">=</span> <span class="n">segment_normal_2d</span><span class="p">(</span><span class="n">seg2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n = __pyx_f_3rbf_8geometry_segment_normal_2d(__pyx_v_seg2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0323</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0324</span>:   <span class="c"># project both points in segment 1 onto the normal vector</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0325</span>:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj1 = (((__pyx_v_seg1.a.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.a.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class="cython line score-0">&#xA0;<span class="">0326</span>:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0327</span>:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj2 = (((__pyx_v_seg1.b.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.b.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class="cython line score-0">&#xA0;<span class="">0328</span>:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0329</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0330</span>:   <span class="k">if</span> <span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_proj1 * __pyx_v_proj2) &gt; 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0331</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0332</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0333</span>:   <span class="c"># return false if the segments are collinear</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0334</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">proj1</span> <span class="o">==</span> <span class="mf">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proj2</span> <span class="o">==</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_proj1 == 0.0) &amp; (__pyx_v_proj2 == 0.0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0335</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0336</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0337</span>:   <span class="c"># find the point where segment 1 intersects the line overlapping </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0338</span>:   <span class="c"># segment 2 </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0339</span>:   <span class="n">pnt</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pnt.x = (__pyx_v_seg1.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.x - __pyx_v_seg1.a.x)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0340</span>:           <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0341</span>:   <span class="n">pnt</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pnt.y = (__pyx_v_seg1.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.y - __pyx_v_seg1.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0342</span>:           <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0343</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>:   <span class="c"># if the normal x component is larger then compare y values</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0345</span>:   <span class="k">if</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((fabs(__pyx_v_n.x) &gt;= fabs(__pyx_v_n.y)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0346</span>:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_pnt.y;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0347</span>:     <span class="n">seg_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_seg2.a.y;
    __pyx_v_seg_proj.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0348</span>:     <span class="n">seg_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_seg2.b.y;
    __pyx_v_seg_proj.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0349</span>:     <span class="k">return</span> <span class="n">point_in_segment</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">seg_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_segment(__pyx_v_pnt_proj, __pyx_v_seg_proj);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0350</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0351</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0352</span>:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_2 = __pyx_v_pnt.x;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0353</span>:     <span class="n">seg_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_seg2.a.x;
    __pyx_v_seg_proj.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0354</span>:     <span class="n">seg_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_seg2.b.x;
    __pyx_v_seg_proj.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0355</span>:     <span class="k">return</span> <span class="n">point_in_segment</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">seg_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_segment(__pyx_v_pnt_proj, __pyx_v_seg_proj);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0356</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0358</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0359</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0360</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_count_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-6 '>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_count_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_count_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_count_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0361</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0362</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0363</span>:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0364</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0365</span>: <span class="sd">  Returns an array containing the number of simplices intersected </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0366</span>: <span class="sd">  between start_pnts and end_pnts. This is parallelizable.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0367</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0368</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0369</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0370</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0371</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0372</span>:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0373</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0374</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0375</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0376</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_13 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0378</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0379</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_intersection_count_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_17 * __pyx_v_out.strides[0]) )) = __pyx_f_3rbf_8geometry__intersection_count_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0380</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0381</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0382</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0383</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0384</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0385</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0386</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_intersection_count_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry__intersection_count_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_count;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0387</span>:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0388</span>:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0389</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0390</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0391</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_count = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0392</span>:     <span class="n">segment2d</span> <span class="n">seg2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0393</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0394</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_simplices.shape[0]);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0395</span>:     <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 0;
    __pyx_t_6 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_4 * __pyx_v_simplices.strides[0]) ) + __pyx_t_5 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_7 = 0;
    __pyx_v_seg2.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_6 * __pyx_v_vertices.strides[0]) ) + __pyx_t_7 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0396</span>:     <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_t_10 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_8 * __pyx_v_simplices.strides[0]) ) + __pyx_t_9 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_11 = 1;
    __pyx_v_seg2.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_10 * __pyx_v_vertices.strides[0]) ) + __pyx_t_11 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0397</span>:     <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 1;
    __pyx_t_14 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_12 * __pyx_v_simplices.strides[0]) ) + __pyx_t_13 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_15 = 0;
    __pyx_v_seg2.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_14 * __pyx_v_vertices.strides[0]) ) + __pyx_t_15 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0398</span>:     <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_i;
    __pyx_t_17 = 1;
    __pyx_t_18 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_16 * __pyx_v_simplices.strides[0]) ) + __pyx_t_17 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_19 = 1;
    __pyx_v_seg2.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_18 * __pyx_v_vertices.strides[0]) ) + __pyx_t_19 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0399</span>:     <span class="k">if</span> <span class="n">is_intersecting_2d</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span><span class="n">seg2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_20 = (__pyx_f_3rbf_8geometry_is_intersecting_2d(__pyx_v_seg1, __pyx_v_seg2) != 0);
    if (__pyx_t_20) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0400</span>:       <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_count = (__pyx_v_count + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0401</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0402</span>:   <span class="k">return</span> <span class="n">count</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_count;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0403</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0404</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0405</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0406</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0407</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_index_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_index_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_index_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_index_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0408</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0410</span>:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>: <span class="sd">  Returns an array identifying which simplex is intersected by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>: <span class="sd">  start_pnts and end_pnts. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0414</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0415</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0416</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0417</span>: <span class="sd">  if there is no intersection then a ValueError is returned. Since an </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>: <span class="sd">  error could potentially be returned, this is not parallelizable.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0421</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0422</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0423</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0424</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 424, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 424, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0425</span>:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0427</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0428</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0429</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0430</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_13 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0431</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0432</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_intersection_index_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_17 = __pyx_f_3rbf_8geometry__intersection_index_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices); if (unlikely(__pyx_t_17 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    __pyx_t_18 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_18 * __pyx_v_out.strides[0]) )) = __pyx_t_17;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0433</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0434</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 434, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 434, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 434, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 434, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 434, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 434, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0+1, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_19, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 434, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 434, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0435</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0436</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0437</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0438</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0440</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_intersection_index_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static int __pyx_f_3rbf_8geometry__intersection_index_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_out;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  double __pyx_v_t;
  double __pyx_v_closest;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_n;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_index_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_25);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_index_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0441</span>:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0442</span>:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0443</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0444</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0445</span>:     <span class="nb">int</span> <span class="n">out</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out = -1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0446</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span><span class="p">,</span><span class="n">t</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0447</span>:     <span class="n">double</span> <span class="n">closest</span> <span class="o">=</span> <span class="mf">999.9</span></pre>
<pre class='cython code score-0 '>  __pyx_v_closest = 999.9;
</pre><pre class="cython line score-0">&#xA0;<span class="">0448</span>:     <span class="n">segment2d</span> <span class="n">seg2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0449</span>:     <span class="n">vector2d</span> <span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0450</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0451</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_simplices.shape[0]);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:     <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 0;
    __pyx_t_6 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_4 * __pyx_v_simplices.strides[0]) ) + __pyx_t_5 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_7 = 0;
    __pyx_v_seg2.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_6 * __pyx_v_vertices.strides[0]) ) + __pyx_t_7 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0453</span>:     <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_t_10 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_8 * __pyx_v_simplices.strides[0]) ) + __pyx_t_9 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_11 = 1;
    __pyx_v_seg2.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_10 * __pyx_v_vertices.strides[0]) ) + __pyx_t_11 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0454</span>:     <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 1;
    __pyx_t_14 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_12 * __pyx_v_simplices.strides[0]) ) + __pyx_t_13 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_15 = 0;
    __pyx_v_seg2.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_14 * __pyx_v_vertices.strides[0]) ) + __pyx_t_15 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0455</span>:     <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_i;
    __pyx_t_17 = 1;
    __pyx_t_18 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_16 * __pyx_v_simplices.strides[0]) ) + __pyx_t_17 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_19 = 1;
    __pyx_v_seg2.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_18 * __pyx_v_vertices.strides[0]) ) + __pyx_t_19 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0456</span>:     <span class="k">if</span> <span class="n">is_intersecting_2d</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span><span class="n">seg2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_20 = (__pyx_f_3rbf_8geometry_is_intersecting_2d(__pyx_v_seg1, __pyx_v_seg2) != 0);
    if (__pyx_t_20) {
/* … */
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0457</span>:       <span class="c"># the intersecting segment should be the first segment </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>:       <span class="c"># intersected when going from seg1.a to seg1.b</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0459</span>:       <span class="n">n</span> <span class="o">=</span> <span class="n">segment_normal_2d</span><span class="p">(</span><span class="n">seg2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_n = __pyx_f_3rbf_8geometry_segment_normal_2d(__pyx_v_seg2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0460</span>:       <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>      __pyx_v_proj1 = (((__pyx_v_seg1.a.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.a.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class="cython line score-0">&#xA0;<span class="">0461</span>:                <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0462</span>:       <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>      __pyx_v_proj2 = (((__pyx_v_seg1.b.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.b.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class="cython line score-0">&#xA0;<span class="">0463</span>:                <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>:       <span class="c"># t is a scalar between 0 and 1. If t=0 then the intersection is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>:       <span class="c"># at seg1.a and if t=1 then the intersection is at seg1.b</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0466</span>:       <span class="n">t</span> <span class="o">=</span> <span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0467</span>:       <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">closest</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = ((__pyx_v_t &lt; __pyx_v_closest) != 0);
      if (__pyx_t_20) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0468</span>:         <span class="n">closest</span> <span class="o">=</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>        __pyx_v_closest = __pyx_v_t;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0469</span>:         <span class="n">out</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>        __pyx_v_out = __pyx_v_i;
</pre><pre class="cython line score-0">&#xA0;<span class="">0470</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0471</span>:   <span class="k">if</span> <span class="n">out</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_20 = ((__pyx_v_out == -1L) != 0);
  if (unlikely(__pyx_t_20)) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0472</span>:     <span class="c"># out is -1 iff no intersection was found</span></pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0473</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;No intersection found for segment [[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">],[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span></pre>
<pre class='cython code score-9 '>    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_No_intersection_found_for_segmen, __pyx_t_25);<span class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
    __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_24);<span class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_25, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
    <span class='error_goto'>__PYX_ERR(0, 473, __pyx_L1_error)</span>
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0474</span>:                      <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class='cython code score-29 '>    __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg1.a.x);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_22 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg1.a.y);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    __pyx_t_23 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg1.b.x);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    __pyx_t_24 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg1.b.y);<span class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    __pyx_t_25 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0, __pyx_t_21);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 1, __pyx_t_22);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 2, __pyx_t_23);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_24);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 3, __pyx_t_24);
    __pyx_t_21 = 0;
    __pyx_t_22 = 0;
    __pyx_t_23 = 0;
    __pyx_t_24 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0475</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0476</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0477</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0478</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0479</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0480</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0481</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_point_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_point_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_point_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_point_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0482</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0483</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0484</span>:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0485</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0486</span>: <span class="sd">  Returns an array of intersection points between the line segments, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0487</span>: <span class="sd">  defined in terms of start_pnts and end_pnts, and the simplices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>: <span class="sd">  if there is no intersection then a ValueError is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0495</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0496</span>:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-41 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 496, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 496, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0497</span>:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>:     <span class="n">vector2d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0500</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0501</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0502</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0503</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_13 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0504</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0505</span>:     <span class="n">vec</span> <span class="o">=</span> <span class="n">_intersection_point_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_f_3rbf_8geometry__intersection_point_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 505, __pyx_L1_error)</span>
    __pyx_v_vec = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0506</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = __pyx_v_vec.x;
    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 0;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_19 * __pyx_v_out.strides[0]) ) + __pyx_t_20 * __pyx_v_out.strides[1]) )) = __pyx_t_18;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0507</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = __pyx_v_vec.y;
    __pyx_t_21 = __pyx_v_i;
    __pyx_t_22 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_21 * __pyx_v_out.strides[0]) ) + __pyx_t_22 * __pyx_v_out.strides[1]) )) = __pyx_t_18;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0508</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0509</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0+1, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_23, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 509, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0510</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0511</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0512</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0515</span>: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">_intersection_point_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry__intersection_point_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_idx;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_point_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_point_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0516</span>:                                      <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0517</span>:                                      <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0520</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0521</span>:     <span class="n">segment2d</span> <span class="n">seg2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0522</span>:     <span class="n">vector2d</span> <span class="n">out</span><span class="p">,</span><span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0523</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0524</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0525</span>:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_intersection_index_2d</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = __pyx_f_3rbf_8geometry__intersection_index_2d(__pyx_v_seg1, __pyx_v_vertices, __pyx_v_simplices); if (unlikely(__pyx_t_1 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0526</span>:   <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_idx;
  __pyx_t_3 = 0;
  __pyx_t_4 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_2 * __pyx_v_simplices.strides[0]) ) + __pyx_t_3 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_5 = 0;
  __pyx_v_seg2.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_4 * __pyx_v_vertices.strides[0]) ) + __pyx_t_5 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0527</span>:   <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_idx;
  __pyx_t_7 = 0;
  __pyx_t_8 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_6 * __pyx_v_simplices.strides[0]) ) + __pyx_t_7 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_9 = 1;
  __pyx_v_seg2.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_8 * __pyx_v_vertices.strides[0]) ) + __pyx_t_9 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0528</span>:   <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_idx;
  __pyx_t_11 = 1;
  __pyx_t_12 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_10 * __pyx_v_simplices.strides[0]) ) + __pyx_t_11 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_13 = 0;
  __pyx_v_seg2.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_12 * __pyx_v_vertices.strides[0]) ) + __pyx_t_13 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0529</span>:   <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __pyx_v_idx;
  __pyx_t_15 = 1;
  __pyx_t_16 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_14 * __pyx_v_simplices.strides[0]) ) + __pyx_t_15 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_17 = 1;
  __pyx_v_seg2.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_16 * __pyx_v_vertices.strides[0]) ) + __pyx_t_17 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0530</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0531</span>:   <span class="n">n</span> <span class="o">=</span> <span class="n">segment_normal_2d</span><span class="p">(</span><span class="n">seg2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n = __pyx_f_3rbf_8geometry_segment_normal_2d(__pyx_v_seg2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0532</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0533</span>:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj1 = (((__pyx_v_seg1.a.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.a.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class="cython line score-0">&#xA0;<span class="">0534</span>:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0535</span>:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj2 = (((__pyx_v_seg1.b.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.b.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class="cython line score-0">&#xA0;<span class="">0536</span>:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0538</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_seg1.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.x - __pyx_v_seg1.a.x)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0539</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (__pyx_v_seg1.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.y - __pyx_v_seg1.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0540</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0541</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0542</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0546</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_normal_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_normal_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_normal_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_normal_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0547</span>:                                        <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>:                                        <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>:                                        <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0551</span>: <span class="sd">  Returns an array of normal vectors to the simplices intersected by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0552</span>: <span class="sd">  the line segments </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0553</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0554</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0555</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0556</span>: <span class="sd">  if there is not intersection then a ValueError is returned</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0557</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0558</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0559</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0561</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0562</span>:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-41 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 562, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 562, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0563</span>:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>:     <span class="n">vector2d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0566</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0567</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0568</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0569</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_13 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0570</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0571</span>:     <span class="n">vec</span> <span class="o">=</span> <span class="n">_intersection_normal_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_f_3rbf_8geometry__intersection_normal_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 571, __pyx_L1_error)</span>
    __pyx_v_vec = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0572</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = __pyx_v_vec.x;
    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 0;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_19 * __pyx_v_out.strides[0]) ) + __pyx_t_20 * __pyx_v_out.strides[1]) )) = __pyx_t_18;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = __pyx_v_vec.y;
    __pyx_t_21 = __pyx_v_i;
    __pyx_t_22 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_21 * __pyx_v_out.strides[0]) ) + __pyx_t_22 * __pyx_v_out.strides[1]) )) = __pyx_t_18;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0574</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0+1, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_23, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0576</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0577</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0578</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0581</span>: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">_intersection_normal_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry__intersection_normal_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  double __pyx_v_proj;
  double __pyx_v_mag;
  int __pyx_v_idx;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_normal_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_normal_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0582</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>:     <span class="n">double</span> <span class="n">proj</span><span class="p">,</span><span class="n">mag</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>:     <span class="n">segment2d</span> <span class="n">seg2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>:     <span class="n">vector2d</span> <span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0590</span>:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_intersection_index_2d</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = __pyx_f_3rbf_8geometry__intersection_index_2d(__pyx_v_seg1, __pyx_v_vertices, __pyx_v_simplices); if (unlikely(__pyx_t_1 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L1_error)</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0591</span>:   <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_idx;
  __pyx_t_3 = 0;
  __pyx_t_4 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_2 * __pyx_v_simplices.strides[0]) ) + __pyx_t_3 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_5 = 0;
  __pyx_v_seg2.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_4 * __pyx_v_vertices.strides[0]) ) + __pyx_t_5 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0592</span>:   <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_idx;
  __pyx_t_7 = 0;
  __pyx_t_8 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_6 * __pyx_v_simplices.strides[0]) ) + __pyx_t_7 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_9 = 1;
  __pyx_v_seg2.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_8 * __pyx_v_vertices.strides[0]) ) + __pyx_t_9 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0593</span>:   <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_idx;
  __pyx_t_11 = 1;
  __pyx_t_12 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_10 * __pyx_v_simplices.strides[0]) ) + __pyx_t_11 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_13 = 0;
  __pyx_v_seg2.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_12 * __pyx_v_vertices.strides[0]) ) + __pyx_t_13 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0594</span>:   <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __pyx_v_idx;
  __pyx_t_15 = 1;
  __pyx_t_16 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_14 * __pyx_v_simplices.strides[0]) ) + __pyx_t_15 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_17 = 1;
  __pyx_v_seg2.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_16 * __pyx_v_vertices.strides[0]) ) + __pyx_t_17 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0595</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0596</span>:   <span class="n">n</span> <span class="o">=</span> <span class="n">segment_normal_2d</span><span class="p">(</span><span class="n">seg2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n = __pyx_f_3rbf_8geometry_segment_normal_2d(__pyx_v_seg2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0597</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0598</span>:   <span class="n">proj</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj = (((__pyx_v_seg1.b.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.b.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class="cython line score-0">&#xA0;<span class="">0599</span>:           <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0600</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0601</span>:   <span class="c"># This ensures that the normal vector points in the direction of seg1</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0602</span>:   <span class="k">if</span> <span class="n">proj</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_18 = ((__pyx_v_proj &lt; 0.0) != 0);
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0603</span>:     <span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n.x = (__pyx_v_n.x * -1.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0604</span>:     <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n.y = (__pyx_v_n.y * -1.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">0605</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>:   <span class="c"># normalize the normal vector to 1</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0607</span>:   <span class="n">mag</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_mag = sqrt((pow(__pyx_v_n.x, 2.0) + pow(__pyx_v_n.y, 2.0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0608</span>:   <span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n.x = (__pyx_v_n.x / __pyx_v_mag);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0609</span>:   <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n.y = (__pyx_v_n.y / __pyx_v_mag);
</pre><pre class="cython line score-0">&#xA0;<span class="">0610</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0611</span>:   <span class="k">return</span> <span class="n">n</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_n;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0612</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0614</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0615</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">contains_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">pnt</span><span class="p">,</span></pre>
<pre class='cython code score-6 '>static PyArrayObject *__pyx_f_3rbf_8geometry_contains_2d(__Pyx_memviewslice __pyx_v_pnt, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_count;
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_outside_pnt;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0617</span>:                             <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0618</span>:                             <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0619</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0620</span>: <span class="sd">  Returns a boolean array identifying which points are contained in </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0621</span>: <span class="sd">  the closed simplicial complex described by vertices and simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0622</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0623</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0624</span>:     <span class="nb">int</span> <span class="n">count</span><span class="p">,</span><span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0625</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_pnt.shape[0]);
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0626</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0627</span>:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0628</span>:     <span class="n">vector2d</span> <span class="n">outside_pnt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0629</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0630</span>:   <span class="n">outside_pnt</span> <span class="o">=</span> <span class="n">find_outside_2d</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_outside_pnt = __pyx_f_3rbf_8geometry_find_outside_2d(__pyx_v_vertices);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0631</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0632</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_outside_pnt.x;
    __pyx_v_seg.a.x = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0633</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_outside_pnt.y;
    __pyx_v_seg.a.y = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0634</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_10 * __pyx_v_pnt.strides[0]) ) + __pyx_t_11 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0635</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_12 * __pyx_v_pnt.strides[0]) ) + __pyx_t_13 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0636</span>:     <span class="n">count</span> <span class="o">=</span> <span class="n">_intersection_count_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_count = __pyx_f_3rbf_8geometry__intersection_count_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0637</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="o">%</span><span class="mf">2</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_14 * __pyx_v_out.strides[0]) )) = __Pyx_mod_long(__pyx_v_count, 2);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0638</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0639</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject*)&amp;PyBool_Type)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0640</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0641</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0642</span>: <span class="c">## 3D point in polygon functions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0643</span>: <span class="c">#####################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0644</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0645</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0646</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0647</span>: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_intersecting_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry_is_intersecting_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri) {
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_pnt;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_pnt_proj;
  struct __pyx_t_3rbf_8geometry_triangle2d __pyx_v_tri_proj;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0648</span>:                              <span class="n">triangle3d</span> <span class="n">tri</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0649</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0650</span>: <span class="sd">  Returns True if the 3D segment intersects the 3D triangle. An </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0651</span>: <span class="sd">  intersection is detected if the segment and triangle are not </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0652</span>: <span class="sd">  coplanar and if any part of the segment touches the triangle at an </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0653</span>: <span class="sd">  edge or in the interior.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0654</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0656</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0657</span>: <span class="sd">  This function determines where the segment intersects the plane</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0658</span>: <span class="sd">  containing the triangle and then projects the intersection point</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0659</span>: <span class="sd">  and triangle into a 2D plane where the point is then tested if it</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0660</span>: <span class="sd">  is within the triangle.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0661</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0662</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0663</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0664</span>:     <span class="n">vector3d</span> <span class="n">pnt</span><span class="p">,</span><span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0665</span>:     <span class="n">vector2d</span> <span class="n">pnt_proj</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0666</span>:     <span class="n">triangle2d</span> <span class="n">tri_proj</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0667</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0668</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0669</span>:   <span class="c"># find triangle normal vector components</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>:   <span class="n">n</span> <span class="o">=</span> <span class="n">triangle_normal_3d</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n = __pyx_f_3rbf_8geometry_triangle_normal_3d(__pyx_v_tri);
</pre><pre class="cython line score-0">&#xA0;<span class="">0671</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0672</span>:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0673</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj1 = ((((__pyx_v_seg.a.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.a.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.a.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0674</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0676</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj2 = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0677</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0678</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0679</span>:   <span class="k">if</span> <span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_proj1 * __pyx_v_proj2) &gt; 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0680</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0681</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0682</span>:   <span class="c"># coplanar segments will always return false</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0683</span>:   <span class="c"># There is a possibility that the segment touches</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0684</span>:   <span class="c"># one point on the triangle</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0685</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">proj1</span> <span class="o">==</span> <span class="mf">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proj2</span> <span class="o">==</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_proj1 == 0.0) &amp; (__pyx_v_proj2 == 0.0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0686</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0687</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0688</span>:   <span class="c"># intersection point</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0689</span>:   <span class="n">pnt</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pnt.x = (__pyx_v_seg.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.x - __pyx_v_seg.a.x)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0690</span>:   <span class="n">pnt</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pnt.y = (__pyx_v_seg.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.y - __pyx_v_seg.a.y)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0691</span>:   <span class="n">pnt</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pnt.z = (__pyx_v_seg.a.z + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.z - __pyx_v_seg.a.z)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0692</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0693</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((fabs(__pyx_v_n.x) &gt;= fabs(__pyx_v_n.y)) &amp; (fabs(__pyx_v_n.x) &gt;= fabs(__pyx_v_n.z))) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0694</span>:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_pnt.y;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_pnt.z;
    __pyx_v_pnt_proj.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.y;
    __pyx_v_tri_proj.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0697</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.z;
    __pyx_v_tri_proj.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0698</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.y;
    __pyx_v_tri_proj.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0699</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.z;
    __pyx_v_tri_proj.b.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0700</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.y;
    __pyx_v_tri_proj.c.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0701</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.z;
    __pyx_v_tri_proj.c.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0702</span>:     <span class="k">return</span> <span class="n">point_in_triangle</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">tri_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_triangle(__pyx_v_pnt_proj, __pyx_v_tri_proj);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0703</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0704</span>:   <span class="k">elif</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((fabs(__pyx_v_n.y) &gt;= fabs(__pyx_v_n.x)) &amp; (fabs(__pyx_v_n.y) &gt;= fabs(__pyx_v_n.z))) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0705</span>:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_pnt.x;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0706</span>:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_pnt.z;
    __pyx_v_pnt_proj.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0707</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.x;
    __pyx_v_tri_proj.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0708</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.z;
    __pyx_v_tri_proj.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0709</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.x;
    __pyx_v_tri_proj.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0710</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.z;
    __pyx_v_tri_proj.b.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0711</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.x;
    __pyx_v_tri_proj.c.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0712</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.z;
    __pyx_v_tri_proj.c.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0713</span>:     <span class="k">return</span> <span class="n">point_in_triangle</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">tri_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_triangle(__pyx_v_pnt_proj, __pyx_v_tri_proj);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0714</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0715</span>:   <span class="k">elif</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((fabs(__pyx_v_n.z) &gt;= fabs(__pyx_v_n.x)) &amp; (fabs(__pyx_v_n.z) &gt;= fabs(__pyx_v_n.y))) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0716</span>:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_pnt.x;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0717</span>:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_pnt.y;
    __pyx_v_pnt_proj.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0718</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.x;
    __pyx_v_tri_proj.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0719</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.y;
    __pyx_v_tri_proj.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0720</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.x;
    __pyx_v_tri_proj.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0721</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.y;
    __pyx_v_tri_proj.b.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0722</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.x;
    __pyx_v_tri_proj.c.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0723</span>:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.y;
    __pyx_v_tri_proj.c.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0724</span>:     <span class="k">return</span> <span class="n">point_in_triangle</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">tri_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_triangle(__pyx_v_pnt_proj, __pyx_v_tri_proj);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0725</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0729</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_count_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_count_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_count_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_count_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0730</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0731</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0733</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0734</span>: <span class="sd">  Returns an array of the number of intersections between each line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0735</span>: <span class="sd">  segment, described by start_pnts and end_pnts, and the simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0736</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0737</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0738</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0739</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0740</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 740, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 740, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0741</span>:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0742</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0743</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0744</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0745</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0746</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 2;
    __pyx_v_seg.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_13 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0747</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0748</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_i;
    __pyx_t_18 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_17 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_18 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0749</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_19 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_20 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0750</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_intersection_count_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_21 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_21 * __pyx_v_out.strides[0]) )) = __pyx_f_3rbf_8geometry__intersection_count_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0751</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0752</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0+1, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_22, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 752, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0753</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0754</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0755</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0756</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_intersection_count_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry__intersection_count_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_count;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0758</span>:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0759</span>:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0760</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0761</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0762</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_count = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0763</span>:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0764</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0765</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_simplices.shape[0]);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0766</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 0;
    __pyx_t_6 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_4 * __pyx_v_simplices.strides[0]) ) + __pyx_t_5 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_7 = 0;
    __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_6 * __pyx_v_vertices.strides[0]) ) + __pyx_t_7 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_t_10 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_8 * __pyx_v_simplices.strides[0]) ) + __pyx_t_9 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_11 = 1;
    __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_10 * __pyx_v_vertices.strides[0]) ) + __pyx_t_11 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0768</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 0;
    __pyx_t_14 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_12 * __pyx_v_simplices.strides[0]) ) + __pyx_t_13 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_15 = 2;
    __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_14 * __pyx_v_vertices.strides[0]) ) + __pyx_t_15 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0769</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_i;
    __pyx_t_17 = 1;
    __pyx_t_18 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_16 * __pyx_v_simplices.strides[0]) ) + __pyx_t_17 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_19 = 0;
    __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_18 * __pyx_v_vertices.strides[0]) ) + __pyx_t_19 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0770</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_i;
    __pyx_t_21 = 1;
    __pyx_t_22 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_20 * __pyx_v_simplices.strides[0]) ) + __pyx_t_21 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_23 = 1;
    __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_22 * __pyx_v_vertices.strides[0]) ) + __pyx_t_23 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0771</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_24 = __pyx_v_i;
    __pyx_t_25 = 1;
    __pyx_t_26 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_24 * __pyx_v_simplices.strides[0]) ) + __pyx_t_25 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_27 = 2;
    __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_26 * __pyx_v_vertices.strides[0]) ) + __pyx_t_27 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0772</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_28 = __pyx_v_i;
    __pyx_t_29 = 2;
    __pyx_t_30 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_28 * __pyx_v_simplices.strides[0]) ) + __pyx_t_29 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_31 = 0;
    __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_30 * __pyx_v_vertices.strides[0]) ) + __pyx_t_31 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0773</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_32 = __pyx_v_i;
    __pyx_t_33 = 2;
    __pyx_t_34 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_32 * __pyx_v_simplices.strides[0]) ) + __pyx_t_33 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_35 = 1;
    __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_34 * __pyx_v_vertices.strides[0]) ) + __pyx_t_35 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_36 = __pyx_v_i;
    __pyx_t_37 = 2;
    __pyx_t_38 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_36 * __pyx_v_simplices.strides[0]) ) + __pyx_t_37 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_39 = 2;
    __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_38 * __pyx_v_vertices.strides[0]) ) + __pyx_t_39 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0775</span>:     <span class="k">if</span> <span class="n">is_intersecting_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">tri</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_40 = (__pyx_f_3rbf_8geometry_is_intersecting_3d(__pyx_v_seg, __pyx_v_tri) != 0);
    if (__pyx_t_40) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0776</span>:       <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_count = (__pyx_v_count + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0777</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0778</span>:   <span class="k">return</span> <span class="n">count</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_count;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0779</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0780</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0781</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0782</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0783</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_index_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_index_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_index_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_index_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0784</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0785</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0786</span>:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0788</span>: <span class="sd">  Returns an array identifying which simplex is intersected by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0789</span>: <span class="sd">  start_pnts and end_pnts. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0790</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0791</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0792</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0793</span>: <span class="sd">  if there is no intersection then a ValueError is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0794</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0795</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0796</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0797</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0798</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0799</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0800</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 800, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 800, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0801</span>:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0802</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0803</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0804</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0805</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0806</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 2;
    __pyx_v_seg.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_13 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0807</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0808</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_i;
    __pyx_t_18 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_17 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_18 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0809</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_19 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_20 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0810</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_intersection_index_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_21 = __pyx_f_3rbf_8geometry__intersection_index_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices); if (unlikely(__pyx_t_21 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 810, __pyx_L1_error)</span>
    __pyx_t_22 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_22 * __pyx_v_out.strides[0]) )) = __pyx_t_21;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0811</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0812</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0+1, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_23, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0813</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0818</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_intersection_index_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-9 '>static int __pyx_f_3rbf_8geometry__intersection_index_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_out;
  int __pyx_v_N;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  double __pyx_v_t;
  double __pyx_v_closest;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_n;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_index_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_41);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_42);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_43);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_44);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_45);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_46);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_47);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_index_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0819</span>:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0823</span>:     <span class="nb">int</span> <span class="n">out</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out = -1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0824</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_simplices.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0825</span>:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span><span class="p">,</span><span class="n">t</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0827</span>:     <span class="n">double</span> <span class="n">closest</span> <span class="o">=</span> <span class="mf">999.9</span></pre>
<pre class='cython code score-0 '>  __pyx_v_closest = 999.9;
</pre><pre class="cython line score-0">&#xA0;<span class="">0828</span>:     <span class="n">vector3d</span> <span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0829</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0830</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_N;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0831</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 0;
    __pyx_t_6 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_4 * __pyx_v_simplices.strides[0]) ) + __pyx_t_5 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_7 = 0;
    __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_6 * __pyx_v_vertices.strides[0]) ) + __pyx_t_7 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0832</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_t_10 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_8 * __pyx_v_simplices.strides[0]) ) + __pyx_t_9 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_11 = 1;
    __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_10 * __pyx_v_vertices.strides[0]) ) + __pyx_t_11 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0833</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 0;
    __pyx_t_14 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_12 * __pyx_v_simplices.strides[0]) ) + __pyx_t_13 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_15 = 2;
    __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_14 * __pyx_v_vertices.strides[0]) ) + __pyx_t_15 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0834</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_i;
    __pyx_t_17 = 1;
    __pyx_t_18 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_16 * __pyx_v_simplices.strides[0]) ) + __pyx_t_17 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_19 = 0;
    __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_18 * __pyx_v_vertices.strides[0]) ) + __pyx_t_19 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0835</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_i;
    __pyx_t_21 = 1;
    __pyx_t_22 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_20 * __pyx_v_simplices.strides[0]) ) + __pyx_t_21 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_23 = 1;
    __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_22 * __pyx_v_vertices.strides[0]) ) + __pyx_t_23 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0836</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_24 = __pyx_v_i;
    __pyx_t_25 = 1;
    __pyx_t_26 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_24 * __pyx_v_simplices.strides[0]) ) + __pyx_t_25 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_27 = 2;
    __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_26 * __pyx_v_vertices.strides[0]) ) + __pyx_t_27 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0837</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_28 = __pyx_v_i;
    __pyx_t_29 = 2;
    __pyx_t_30 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_28 * __pyx_v_simplices.strides[0]) ) + __pyx_t_29 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_31 = 0;
    __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_30 * __pyx_v_vertices.strides[0]) ) + __pyx_t_31 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0838</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_32 = __pyx_v_i;
    __pyx_t_33 = 2;
    __pyx_t_34 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_32 * __pyx_v_simplices.strides[0]) ) + __pyx_t_33 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_35 = 1;
    __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_34 * __pyx_v_vertices.strides[0]) ) + __pyx_t_35 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0839</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_36 = __pyx_v_i;
    __pyx_t_37 = 2;
    __pyx_t_38 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_36 * __pyx_v_simplices.strides[0]) ) + __pyx_t_37 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_39 = 2;
    __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_38 * __pyx_v_vertices.strides[0]) ) + __pyx_t_39 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0840</span>:     <span class="k">if</span> <span class="n">is_intersecting_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">tri</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_40 = (__pyx_f_3rbf_8geometry_is_intersecting_3d(__pyx_v_seg, __pyx_v_tri) != 0);
    if (__pyx_t_40) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0841</span>:       <span class="n">n</span> <span class="o">=</span> <span class="n">triangle_normal_3d</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_n = __pyx_f_3rbf_8geometry_triangle_normal_3d(__pyx_v_tri);
</pre><pre class="cython line score-0">&#xA0;<span class="">0842</span>:       <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0843</span>:                <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>      __pyx_v_proj1 = ((((__pyx_v_seg.a.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.a.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.a.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0844</span>:                <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0845</span>:       <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0846</span>:                <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>      __pyx_v_proj2 = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0847</span>:                <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0848</span>:       <span class="c"># t is a scalar between 0 and 1. If t=0 then the intersection is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0849</span>:       <span class="c"># at seg1.a and if t=1 then the intersection is at seg1.b</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0850</span>:       <span class="n">t</span> <span class="o">=</span> <span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0851</span>:       <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">closest</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_40 = ((__pyx_v_t &lt; __pyx_v_closest) != 0);
      if (__pyx_t_40) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0852</span>:         <span class="n">closest</span> <span class="o">=</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>        __pyx_v_closest = __pyx_v_t;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0853</span>:         <span class="n">out</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>        __pyx_v_out = __pyx_v_i;
</pre><pre class="cython line score-0">&#xA0;<span class="">0854</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0855</span>:   <span class="k">if</span> <span class="n">out</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_40 = ((__pyx_v_out == -1L) != 0);
  if (unlikely(__pyx_t_40)) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0856</span>:     <span class="c"># out is -1 iff it has never been changed and no intersection was found</span></pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0857</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;No intersection found for segment [[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">],[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span></pre>
<pre class='cython code score-9 '>    __pyx_t_46 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_No_intersection_found_for_segmen_2, __pyx_t_47);<span class='error_goto'> if (unlikely(!__pyx_t_46)) __PYX_ERR(0, 857, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_46);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_47); __pyx_t_47 = 0;
    __pyx_t_47 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_46);<span class='error_goto'> if (unlikely(!__pyx_t_47)) __PYX_ERR(0, 857, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_47);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_46); __pyx_t_46 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_47, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_47); __pyx_t_47 = 0;
    <span class='error_goto'>__PYX_ERR(0, 857, __pyx_L1_error)</span>
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0858</span>:                      <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="p">))</span></pre>
<pre class='cython code score-41 '>    __pyx_t_41 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.x);<span class='error_goto'> if (unlikely(!__pyx_t_41)) __PYX_ERR(0, 858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
    __pyx_t_42 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.y);<span class='error_goto'> if (unlikely(!__pyx_t_42)) __PYX_ERR(0, 858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
    __pyx_t_43 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.z);<span class='error_goto'> if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_43);
    __pyx_t_44 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.x);<span class='error_goto'> if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_44);
    __pyx_t_45 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.y);<span class='error_goto'> if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_45);
    __pyx_t_46 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.z);<span class='error_goto'> if (unlikely(!__pyx_t_46)) __PYX_ERR(0, 858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_46);
    __pyx_t_47 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_47)) __PYX_ERR(0, 858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_47);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_41);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_47, 0, __pyx_t_41);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_42);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_47, 1, __pyx_t_42);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_43);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_47, 2, __pyx_t_43);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_44);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_47, 3, __pyx_t_44);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_45);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_47, 4, __pyx_t_45);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_46);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_47, 5, __pyx_t_46);
    __pyx_t_41 = 0;
    __pyx_t_42 = 0;
    __pyx_t_43 = 0;
    __pyx_t_44 = 0;
    __pyx_t_45 = 0;
    __pyx_t_46 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0859</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0860</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0861</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0865</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_point_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_point_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_vec;
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_point_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_29);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_point_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0866</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0867</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0868</span>:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0869</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>: <span class="sd">  Returns the intersection points between the line segments,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0871</span>: <span class="sd">  described by start_pnts and end_pnts, and the simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0872</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0873</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0874</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0875</span>: <span class="sd">  if there is no intersection then a ValueError is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0876</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0879</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0880</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0881</span>:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-41 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 881, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 881, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0882</span>:     <span class="n">vector3d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0883</span>:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0884</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0885</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0886</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0887</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0888</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 2;
    __pyx_v_seg.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_13 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0889</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0890</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_i;
    __pyx_t_18 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_17 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_18 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0891</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_19 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_20 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0892</span>:     <span class="n">vec</span> <span class="o">=</span> <span class="n">_intersection_point_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_21 = __pyx_f_3rbf_8geometry__intersection_point_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)</span>
    __pyx_v_vec = __pyx_t_21;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0893</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_22 = __pyx_v_vec.x;
    __pyx_t_23 = __pyx_v_i;
    __pyx_t_24 = 0;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_23 * __pyx_v_out.strides[0]) ) + __pyx_t_24 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0894</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_22 = __pyx_v_vec.y;
    __pyx_t_25 = __pyx_v_i;
    __pyx_t_26 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_25 * __pyx_v_out.strides[0]) ) + __pyx_t_26 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0895</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_22 = __pyx_v_vec.z;
    __pyx_t_27 = __pyx_v_i;
    __pyx_t_28 = 2;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_27 * __pyx_v_out.strides[0]) ) + __pyx_t_28 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0896</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0897</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_29 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_29);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 0+1, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_29, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 897, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0898</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0903</span>: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">_intersection_point_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry__intersection_point_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  int __pyx_v_idx;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_point_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_point_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0904</span>:                                      <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0905</span>:                                      <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0906</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0907</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0908</span>:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0909</span>:     <span class="n">vector3d</span> <span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0910</span>:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0911</span>:     <span class="n">vector3d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0912</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0913</span>:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_intersection_index_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = __pyx_f_3rbf_8geometry__intersection_index_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices); if (unlikely(__pyx_t_1 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 913, __pyx_L1_error)</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0914</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_idx;
  __pyx_t_3 = 0;
  __pyx_t_4 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_2 * __pyx_v_simplices.strides[0]) ) + __pyx_t_3 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_5 = 0;
  __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_4 * __pyx_v_vertices.strides[0]) ) + __pyx_t_5 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0915</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_idx;
  __pyx_t_7 = 0;
  __pyx_t_8 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_6 * __pyx_v_simplices.strides[0]) ) + __pyx_t_7 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_9 = 1;
  __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_8 * __pyx_v_vertices.strides[0]) ) + __pyx_t_9 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0916</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_idx;
  __pyx_t_11 = 0;
  __pyx_t_12 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_10 * __pyx_v_simplices.strides[0]) ) + __pyx_t_11 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_13 = 2;
  __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_12 * __pyx_v_vertices.strides[0]) ) + __pyx_t_13 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0917</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __pyx_v_idx;
  __pyx_t_15 = 1;
  __pyx_t_16 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_14 * __pyx_v_simplices.strides[0]) ) + __pyx_t_15 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_17 = 0;
  __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_16 * __pyx_v_vertices.strides[0]) ) + __pyx_t_17 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0918</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_18 = __pyx_v_idx;
  __pyx_t_19 = 1;
  __pyx_t_20 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_18 * __pyx_v_simplices.strides[0]) ) + __pyx_t_19 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_21 = 1;
  __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_20 * __pyx_v_vertices.strides[0]) ) + __pyx_t_21 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0919</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_22 = __pyx_v_idx;
  __pyx_t_23 = 1;
  __pyx_t_24 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_22 * __pyx_v_simplices.strides[0]) ) + __pyx_t_23 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_25 = 2;
  __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_24 * __pyx_v_vertices.strides[0]) ) + __pyx_t_25 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0920</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_26 = __pyx_v_idx;
  __pyx_t_27 = 2;
  __pyx_t_28 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_26 * __pyx_v_simplices.strides[0]) ) + __pyx_t_27 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_29 = 0;
  __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_28 * __pyx_v_vertices.strides[0]) ) + __pyx_t_29 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0921</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_30 = __pyx_v_idx;
  __pyx_t_31 = 2;
  __pyx_t_32 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_30 * __pyx_v_simplices.strides[0]) ) + __pyx_t_31 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_33 = 1;
  __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_32 * __pyx_v_vertices.strides[0]) ) + __pyx_t_33 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0922</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_34 = __pyx_v_idx;
  __pyx_t_35 = 2;
  __pyx_t_36 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_34 * __pyx_v_simplices.strides[0]) ) + __pyx_t_35 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_37 = 2;
  __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_36 * __pyx_v_vertices.strides[0]) ) + __pyx_t_37 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0923</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0924</span>:   <span class="n">n</span> <span class="o">=</span> <span class="n">triangle_normal_3d</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n = __pyx_f_3rbf_8geometry_triangle_normal_3d(__pyx_v_tri);
</pre><pre class="cython line score-0">&#xA0;<span class="">0925</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0926</span>:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0927</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj1 = ((((__pyx_v_seg.a.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.a.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.a.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0928</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0930</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj2 = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0931</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0933</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_seg.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.x - __pyx_v_seg.a.x)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0934</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (__pyx_v_seg.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.y - __pyx_v_seg.a.y)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0935</span>:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.z = (__pyx_v_seg.a.z + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.z - __pyx_v_seg.a.z)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0936</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0937</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0938</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0939</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0940</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0941</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0942</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_normal_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_normal_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_normal_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_29);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_normal_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0943</span>:                                        <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0944</span>:                                        <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>:                                        <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0946</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0947</span>: <span class="sd">  Returns the normal vectors to the simplices intersected by </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>: <span class="sd">  start_pnts and end_pnts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>: <span class="sd">  if there is no intersection then a ValueError is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0958</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0959</span>:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-41 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 959, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 959, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 959, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 959, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 959, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 959, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 959, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 959, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 959, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 959, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0960</span>:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>:     <span class="n">vector3d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0963</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0964</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0965</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0966</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 2;
    __pyx_v_seg.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_13 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0967</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0968</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_i;
    __pyx_t_18 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_17 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_18 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0969</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_19 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_20 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0970</span>:     <span class="n">vec</span> <span class="o">=</span> <span class="n">_intersection_normal_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_21 = __pyx_f_3rbf_8geometry__intersection_normal_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 970, __pyx_L1_error)</span>
    __pyx_v_vec = __pyx_t_21;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0971</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_22 = __pyx_v_vec.x;
    __pyx_t_23 = __pyx_v_i;
    __pyx_t_24 = 0;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_23 * __pyx_v_out.strides[0]) ) + __pyx_t_24 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0972</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_22 = __pyx_v_vec.y;
    __pyx_t_25 = __pyx_v_i;
    __pyx_t_26 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_25 * __pyx_v_out.strides[0]) ) + __pyx_t_26 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0973</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_22 = __pyx_v_vec.z;
    __pyx_t_27 = __pyx_v_i;
    __pyx_t_28 = 2;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_27 * __pyx_v_out.strides[0]) ) + __pyx_t_28 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0974</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0975</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_29 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_29);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 0+1, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_29, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 975, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0976</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0977</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0978</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0979</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0980</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0981</span>: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">_intersection_normal_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry__intersection_normal_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  double __pyx_v_proj;
  double __pyx_v_mag;
  int __pyx_v_idx;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_normal_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_normal_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0982</span>:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0983</span>:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>:     <span class="n">double</span> <span class="n">proj</span><span class="p">,</span><span class="n">mag</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>:     <span class="n">vector3d</span> <span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0990</span>:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_intersection_index_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = __pyx_f_3rbf_8geometry__intersection_index_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices); if (unlikely(__pyx_t_1 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0991</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_idx;
  __pyx_t_3 = 0;
  __pyx_t_4 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_2 * __pyx_v_simplices.strides[0]) ) + __pyx_t_3 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_5 = 0;
  __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_4 * __pyx_v_vertices.strides[0]) ) + __pyx_t_5 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0992</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_idx;
  __pyx_t_7 = 0;
  __pyx_t_8 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_6 * __pyx_v_simplices.strides[0]) ) + __pyx_t_7 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_9 = 1;
  __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_8 * __pyx_v_vertices.strides[0]) ) + __pyx_t_9 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0993</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_idx;
  __pyx_t_11 = 0;
  __pyx_t_12 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_10 * __pyx_v_simplices.strides[0]) ) + __pyx_t_11 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_13 = 2;
  __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_12 * __pyx_v_vertices.strides[0]) ) + __pyx_t_13 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0994</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __pyx_v_idx;
  __pyx_t_15 = 1;
  __pyx_t_16 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_14 * __pyx_v_simplices.strides[0]) ) + __pyx_t_15 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_17 = 0;
  __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_16 * __pyx_v_vertices.strides[0]) ) + __pyx_t_17 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0995</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_18 = __pyx_v_idx;
  __pyx_t_19 = 1;
  __pyx_t_20 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_18 * __pyx_v_simplices.strides[0]) ) + __pyx_t_19 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_21 = 1;
  __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_20 * __pyx_v_vertices.strides[0]) ) + __pyx_t_21 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0996</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_22 = __pyx_v_idx;
  __pyx_t_23 = 1;
  __pyx_t_24 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_22 * __pyx_v_simplices.strides[0]) ) + __pyx_t_23 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_25 = 2;
  __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_24 * __pyx_v_vertices.strides[0]) ) + __pyx_t_25 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0997</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_26 = __pyx_v_idx;
  __pyx_t_27 = 2;
  __pyx_t_28 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_26 * __pyx_v_simplices.strides[0]) ) + __pyx_t_27 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_29 = 0;
  __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_28 * __pyx_v_vertices.strides[0]) ) + __pyx_t_29 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0998</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_30 = __pyx_v_idx;
  __pyx_t_31 = 2;
  __pyx_t_32 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_30 * __pyx_v_simplices.strides[0]) ) + __pyx_t_31 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_33 = 1;
  __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_32 * __pyx_v_vertices.strides[0]) ) + __pyx_t_33 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0999</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_34 = __pyx_v_idx;
  __pyx_t_35 = 2;
  __pyx_t_36 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_34 * __pyx_v_simplices.strides[0]) ) + __pyx_t_35 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_37 = 2;
  __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_36 * __pyx_v_vertices.strides[0]) ) + __pyx_t_37 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1000</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1001</span>:   <span class="n">n</span> <span class="o">=</span> <span class="n">triangle_normal_3d</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n = __pyx_f_3rbf_8geometry_triangle_normal_3d(__pyx_v_tri);
</pre><pre class="cython line score-0">&#xA0;<span class="">1002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1003</span>:   <span class="n">proj</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1004</span>:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">1005</span>:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1007</span>:   <span class="c"># ensures that normal points in the direction of the segment</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1008</span>:   <span class="k">if</span> <span class="n">proj</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_38 = ((__pyx_v_proj &lt; 0.0) != 0);
  if (__pyx_t_38) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1009</span>:     <span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n.x = (__pyx_v_n.x * -1.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1010</span>:     <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n.y = (__pyx_v_n.y * -1.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1011</span>:     <span class="n">n</span><span class="o">.</span><span class="n">z</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n.z = (__pyx_v_n.z * -1.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">1012</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1013</span>:   <span class="n">mag</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_mag = sqrt(((pow(__pyx_v_n.x, 2.0) + pow(__pyx_v_n.y, 2.0)) + pow(__pyx_v_n.z, 2.0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1014</span>:   <span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n.x = (__pyx_v_n.x / __pyx_v_mag);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1015</span>:   <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n.y = (__pyx_v_n.y / __pyx_v_mag);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1016</span>:   <span class="n">n</span><span class="o">.</span><span class="n">z</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n.z = (__pyx_v_n.z / __pyx_v_mag);
</pre><pre class="cython line score-0">&#xA0;<span class="">1017</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1018</span>:   <span class="k">return</span> <span class="n">n</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_n;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1021</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1022</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1023</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">contains_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">pnt</span><span class="p">,</span></pre>
<pre class='cython code score-6 '>static PyArrayObject *__pyx_f_3rbf_8geometry_contains_3d(__Pyx_memviewslice __pyx_v_pnt, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_count;
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_outside_pnt;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1024</span>:                             <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1025</span>:                             <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1026</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1027</span>: <span class="sd">  Returns a boolean array identifying whether the points are contained </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1028</span>: <span class="sd">  within the closed simplicial complex described by vertices and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1029</span>: <span class="sd">  simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1030</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1031</span>:   <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1032</span>:     <span class="nb">int</span> <span class="n">count</span><span class="p">,</span><span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1033</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_pnt.shape[0]);
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1034</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1034, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1034, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1034, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1034, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1034, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1034, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1034, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1034, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1034, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1034, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1035</span>:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1036</span>:     <span class="n">vector3d</span> <span class="n">outside_pnt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1037</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1038</span>:   <span class="n">outside_pnt</span> <span class="o">=</span> <span class="n">find_outside_3d</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_outside_pnt = __pyx_f_3rbf_8geometry_find_outside_3d(__pyx_v_vertices);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1039</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1040</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_outside_pnt.x;
    __pyx_v_seg.a.x = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1041</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_outside_pnt.y;
    __pyx_v_seg.a.y = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1042</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_outside_pnt.z;
    __pyx_v_seg.a.z = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1043</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_10 * __pyx_v_pnt.strides[0]) ) + __pyx_t_11 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1044</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_12 * __pyx_v_pnt.strides[0]) ) + __pyx_t_13 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1045</span>:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_14 * __pyx_v_pnt.strides[0]) ) + __pyx_t_15 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1046</span>:     <span class="n">count</span> <span class="o">=</span> <span class="n">_intersection_count_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_count = __pyx_f_3rbf_8geometry__intersection_count_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1047</span>:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="o">%</span><span class="mf">2</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_16 * __pyx_v_out.strides[0]) )) = __Pyx_mod_long(__pyx_v_count, 2);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1048</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1049</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1049, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1049, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1049, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject*)&amp;PyBool_Type)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1049, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1049, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1050</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1051</span>: <span class="c">## end-user functions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1052</span>: <span class="c">#####################################################################</span></pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1053</span>: <span class="k">def</span> <span class="nf">intersection_point</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-67 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_1intersection_point(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_intersection_point[] = " \n  Returns the intersection points between line segments and a \n  simplicial complex.  The line segments are described by \n  `start_points` and `end_points`, and the simplicial complex is \n  described by `vertices` and `simplices`. This function works for 1, \n  2, and 3 spatial dimensions.\n\n  Parameters\n  ----------\n  start_points : (N,D) array\n    Vertices describing one end of the line segments. `N` is the \n    number of line segments and `D` is the number of dimensions\n\n  end_points : (N,D) array \n    Vertices describing the other end of the line segments. \n\n  vertices : (M,D) array \n    Vertices within the simplicial complex. M is the number of \n    vertices.\n\n  simplices : (P,D) array\n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n  out : (N,D) array\n    intersection points    \n\n  Notes\n  -----\n  This function fails when a intersection is not found for a line \n  segment. If there are multiple intersections then the intersection \n  closest to start_point is used.\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_1intersection_point = {"intersection_point", (PyCFunction)__pyx_pw_3rbf_8geometry_1intersection_point, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_intersection_point};
static PyObject *__pyx_pw_3rbf_8geometry_1intersection_point(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_point (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_point", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_point", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_point", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersection_point") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_point", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_point", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_intersection_point(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_intersection_point(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_crossed_idx = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_point", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_point", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__75 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_crossed_idx, __pyx_n_s_vert, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__75);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__75);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_1intersection_point, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_intersection_point, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__76 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__75, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_intersection_point, 1053, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__76)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1054</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1055</span>: <span class="sd">  Returns the intersection points between line segments and a </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1056</span>: <span class="sd">  simplicial complex.  The line segments are described by </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1057</span>: <span class="sd">  `start_points` and `end_points`, and the simplicial complex is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1058</span>: <span class="sd">  described by `vertices` and `simplices`. This function works for 1, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1059</span>: <span class="sd">  2, and 3 spatial dimensions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1060</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1061</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1062</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1063</span>: <span class="sd">  start_points : (N,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1064</span>: <span class="sd">    Vertices describing one end of the line segments. `N` is the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1065</span>: <span class="sd">    number of line segments and `D` is the number of dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1067</span>: <span class="sd">  end_points : (N,D) array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1068</span>: <span class="sd">    Vertices describing the other end of the line segments. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1069</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1070</span>: <span class="sd">  vertices : (M,D) array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1071</span>: <span class="sd">    Vertices within the simplicial complex. M is the number of </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1072</span>: <span class="sd">    vertices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1073</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1074</span>: <span class="sd">  simplices : (P,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1075</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1076</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1077</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1078</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1079</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1080</span>: <span class="sd">  out : (N,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1081</span>: <span class="sd">    intersection points    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1083</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1084</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1085</span>: <span class="sd">  This function fails when a intersection is not found for a line </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1086</span>: <span class="sd">  segment. If there are multiple intersections then the intersection </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1087</span>: <span class="sd">  closest to start_point is used.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1088</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1089</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1090</span>:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1091</span>:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1091, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1092</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1093</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1093, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1093, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1093, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1093, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1093, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1093, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1094</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L1_error)</span>
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 1095, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class="cython line score-0">&#xA0;<span class="">1096</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1097</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1097, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = ((!__pyx_t_6) != 0);
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1098</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1098, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1098, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 1098, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class="cython line score-0">&#xA0;<span class="">1099</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1100</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1101</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;start points and end points must have the same length&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1101, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_start_points_and_end_points_must);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 1101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0">&#xA0;<span class="">1102</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1103</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1105</span>:     <span class="n">crossed_idx</span> <span class="o">=</span> <span class="n">intersection_index</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_intersection_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_7 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[5] = {__pyx_t_2, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[5] = {__pyx_t_2, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_2) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_7, __pyx_v_start_points);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_7, __pyx_v_end_points);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_7, __pyx_v_vertices);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3+__pyx_t_7, __pyx_v_simplices);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_crossed_idx = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1106</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__4 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__4)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);
/* … */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_vert = __pyx_t_1;
    __pyx_t_1 = 0;
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__4, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1107</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">vert</span><span class="p">[</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_crossed_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1108</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1109</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1109, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1110</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_point_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_point_2d(__pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1111</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_6)) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1113</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_point_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_point_3d(__pyx_t_10, __pyx_t_9, __pyx_t_8, __pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1115</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1116</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>  /*else*/ {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1116, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1116, __pyx_L1_error)</span>
  }
  __pyx_L6:;
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_intersections_can_only_be_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 1116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class="cython line score-0">&#xA0;<span class="">1117</span>:       <span class="s">&#39;intersections can only be found for a 1, 2, or 3 dimensional &#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1118</span>:       <span class="s">&#39;simplicial complex&#39;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1119</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1120</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1121</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1122</span>: </pre>
<pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1123</span>: <span class="k">def</span> <span class="nf">intersection_normal</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-68 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_3intersection_normal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_2intersection_normal[] = " \n  Returns the normal vectors to the simplices intersected by the line \n  segments. The line segments are described by `start_points` and \n  `end_points`. This function works for 1, 2, and 3 spatial \n  dimensions. The normal vector is in the direction that points \n  towards end_points\n\n  Parameters\n  ----------\n  start_points : (N,D) array\n    Vertices describing one end of the line segments. `N` is the \n    number of line segments and `D` is the number of dimensions.\n\n  end_points : (N,D) array \n    Vertices describing the other end of the line segments.\n\n  vertices : (M,D) array \n    Vertices within the simplicial complex. `M` is the number of \n    vertices\n\n  simplices : (P,D) array\n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n  out : (N,D) array\n    normal vectors\n\n  Notes\n  -----\n  This function fails when a intersection is not found for a line \n  segment. If there are multiple intersections then the intersection \n  closest to start_point is used.\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_3intersection_normal = {"intersection_normal", (PyCFunction)__pyx_pw_3rbf_8geometry_3intersection_normal, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_2intersection_normal};
static PyObject *__pyx_pw_3rbf_8geometry_3intersection_normal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_normal (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_normal", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1123, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_normal", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1123, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_normal", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 1123, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersection_normal") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1123, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_normal", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1123, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_normal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_2intersection_normal(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_2intersection_normal(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_crossed_idx = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_crossed_vert = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_normal", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_normal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__77 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_out, __pyx_n_s_crossed_idx, __pyx_n_s_vert, __pyx_n_s_crossed_vert);<span class='error_goto'> if (unlikely(!__pyx_tuple__77)) __PYX_ERR(0, 1123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__77);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__77);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_3intersection_normal, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_intersection_normal, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1123, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__78 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__77, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_intersection_normal, 1123, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__78)) __PYX_ERR(0, 1123, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1124</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1125</span>: <span class="sd">  Returns the normal vectors to the simplices intersected by the line </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1126</span>: <span class="sd">  segments. The line segments are described by `start_points` and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1127</span>: <span class="sd">  `end_points`. This function works for 1, 2, and 3 spatial </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1128</span>: <span class="sd">  dimensions. The normal vector is in the direction that points </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1129</span>: <span class="sd">  towards end_points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1130</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1131</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1132</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1133</span>: <span class="sd">  start_points : (N,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1134</span>: <span class="sd">    Vertices describing one end of the line segments. `N` is the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1135</span>: <span class="sd">    number of line segments and `D` is the number of dimensions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1136</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1137</span>: <span class="sd">  end_points : (N,D) array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1138</span>: <span class="sd">    Vertices describing the other end of the line segments.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1139</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1140</span>: <span class="sd">  vertices : (M,D) array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1141</span>: <span class="sd">    Vertices within the simplicial complex. `M` is the number of </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1142</span>: <span class="sd">    vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1143</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1144</span>: <span class="sd">  simplices : (P,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1145</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1146</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1148</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1149</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1150</span>: <span class="sd">  out : (N,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1151</span>: <span class="sd">    normal vectors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1152</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1153</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1154</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1155</span>: <span class="sd">  This function fails when a intersection is not found for a line </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1156</span>: <span class="sd">  segment. If there are multiple intersections then the intersection </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1157</span>: <span class="sd">  closest to start_point is used.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1159</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1160</span>:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1160, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1161</span>:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1161, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1162</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1163</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1163, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1164</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1165</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1165, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1165, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 1165, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class="cython line score-0">&#xA0;<span class="">1166</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1167</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1167, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1167, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1167, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1167, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1167, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1167, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = ((!__pyx_t_6) != 0);
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1168</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1168, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 1168, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class="cython line score-0">&#xA0;<span class="">1169</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1170</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1170, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1171</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;start points and end points must have the same length&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1171, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1171, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_start_points_and_end_points_must);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 1171, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
</pre><pre class="cython line score-0">&#xA0;<span class="">1172</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1173</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1174</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1174, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1174, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1175</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1175, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_out = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1176</span>:     <span class="n">crossed_idx</span> <span class="o">=</span> <span class="n">intersection_index</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_intersection_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1176, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[5] = {__pyx_t_2, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1176, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[5] = {__pyx_t_2, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1176, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else
    #endif
    {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1176, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (__pyx_t_2) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_7, __pyx_v_start_points);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_7, __pyx_v_end_points);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2+__pyx_t_7, __pyx_v_vertices);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3+__pyx_t_7, __pyx_v_simplices);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1176, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_crossed_idx = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1177</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__10 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__10)) __PYX_ERR(0, 1177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__10);
/* … */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1177, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1177, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_vert = __pyx_t_3;
    __pyx_t_3 = 0;
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__10, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 1177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1178</span>:     <span class="n">crossed_vert</span> <span class="o">=</span> <span class="n">vert</span><span class="p">[</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_crossed_idx);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1178, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_v_crossed_vert = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1179</span>:     <span class="n">out</span><span class="p">[</span><span class="n">crossed_vert</span> <span class="o">&lt;</span> <span class="n">start_points</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span></pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_crossed_vert, __pyx_v_start_points, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_t_3, __pyx_float_neg_1_0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1179, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1180</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1181</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1182</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_normal_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
    __pyx_t_3 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_normal_2d(__pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
    __pyx_v_out = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1183</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1184</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1184, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1184, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(__pyx_t_6)) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1185</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_normal_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1185, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1185, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1185, __pyx_L1_error)</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1185, __pyx_L1_error)</span>
    __pyx_t_3 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_normal_3d(__pyx_t_10, __pyx_t_9, __pyx_t_8, __pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
    __pyx_v_out = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1187</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1188</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1188, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1188, __pyx_L1_error)</span>
  }
  __pyx_L6:;
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_intersections_can_only_be_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 1188, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-0">&#xA0;<span class="">1189</span>:       <span class="s">&#39;intersections can only be found for a 1, 2, or 3 dimensional &#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1190</span>:       <span class="s">&#39;simplicial complex&#39;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1191</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1192</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1193</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1194</span>: </pre>
<pre class="cython line score-76" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1195</span>: <span class="k">def</span> <span class="nf">intersection_index</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-76 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_5intersection_index(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_4intersection_index[] = " \n  Returns the indices of the simplices intersected by the line \n  segments. The line segments are described by `start_points` and \n  `end_points`. This function works for 1, 2, and 3 spatial \n  dimensions. \n\n  Parameters\n  ----------\n  start_points : (N,D) array\n    Vertices describing one end of the line segments. `N` is the \n    number of line segments and `D` is the number of dimensions\n\n  end_points : (N,D) array \n    Vertices describing the other end of the line segments\n\n  vertices : (M,D) array \n    Vertices within the simplicial complex. `M` is the number of \n    vertices\n\n  simplices : (P,D) array\n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n  out : (N,) int array\n    simplex indices \n\n  Notes\n  -----\n  This function fails when a intersection is not found for a line\n  segment. If there are multiple intersections then the intersection \n  closest to `start_point` is used.\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_5intersection_index = {"intersection_index", (PyCFunction)__pyx_pw_3rbf_8geometry_5intersection_index, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_4intersection_index};
static PyObject *__pyx_pw_3rbf_8geometry_5intersection_index(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_index (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_index", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1195, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_index", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1195, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_index", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 1195, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersection_index") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1195, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_index", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1195, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_4intersection_index(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_4intersection_index(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_proj1 = NULL;
  PyObject *__pyx_v_proj2 = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_crossed_idx = NULL;
  PyObject *__pyx_v_proj1i = NULL;
  PyObject *__pyx_v_proj2i = NULL;
  PyObject *__pyx_v_idx = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_index", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj1i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj2i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__79 = <span class='py_c_api'>PyTuple_Pack</span>(15, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_out, __pyx_n_s_vert, __pyx_n_s_proj1, __pyx_n_s_proj2, __pyx_n_s_crossed_bool, __pyx_n_s_i, __pyx_n_s_crossed_idx, __pyx_n_s_proj1i, __pyx_n_s_proj2i, __pyx_n_s_idx);<span class='error_goto'> if (unlikely(!__pyx_tuple__79)) __PYX_ERR(0, 1195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__79);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__79);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_5intersection_index, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_intersection_index, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1195, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__80 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__79, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_intersection_index, 1195, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__80)) __PYX_ERR(0, 1195, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1196</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1197</span>: <span class="sd">  Returns the indices of the simplices intersected by the line </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1198</span>: <span class="sd">  segments. The line segments are described by `start_points` and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1199</span>: <span class="sd">  `end_points`. This function works for 1, 2, and 3 spatial </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1200</span>: <span class="sd">  dimensions. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1201</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1202</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1203</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1204</span>: <span class="sd">  start_points : (N,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1205</span>: <span class="sd">    Vertices describing one end of the line segments. `N` is the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1206</span>: <span class="sd">    number of line segments and `D` is the number of dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1208</span>: <span class="sd">  end_points : (N,D) array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1209</span>: <span class="sd">    Vertices describing the other end of the line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1210</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1211</span>: <span class="sd">  vertices : (M,D) array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1212</span>: <span class="sd">    Vertices within the simplicial complex. `M` is the number of </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1213</span>: <span class="sd">    vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1214</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1215</span>: <span class="sd">  simplices : (P,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1216</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1217</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1219</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1220</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1221</span>: <span class="sd">  out : (N,) int array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>: <span class="sd">    simplex indices </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1223</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1224</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1225</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1226</span>: <span class="sd">  This function fails when a intersection is not found for a line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1227</span>: <span class="sd">  segment. If there are multiple intersections then the intersection </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1228</span>: <span class="sd">  closest to `start_point` is used.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1229</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1230</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1231</span>:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1231, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1231, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1231, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1231, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1231, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1231, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1232</span>:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1233</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1233, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1233, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1233, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1233, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1233, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1233, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1234</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1234, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1235</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1236</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimesions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1236, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1236, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimesions);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 1236, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class="cython line score-0">&#xA0;<span class="">1237</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1238</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1238, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1238, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = ((!__pyx_t_6) != 0);
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1239</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1239, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1239, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 1239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
</pre><pre class="cython line score-0">&#xA0;<span class="">1240</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1241</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1241, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1241, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1242</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;start points and end points must have the same length&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1242, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1242, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_start_points_and_end_points_must);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 1242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
</pre><pre class="cython line score-0">&#xA0;<span class="">1243</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1244</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1244, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1244, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1245</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1245, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1246</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1246, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_out = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1247</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__16 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__16)) __PYX_ERR(0, 1247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__16);
/* … */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__17);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1247, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1247, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_vert = __pyx_t_2;
    __pyx_t_2 = 0;
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__16, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 1247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1248</span>:     <span class="n">proj1</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1248, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_start_points, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1248, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_proj1 = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1249</span>:     <span class="n">proj2</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_proj2 = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1250</span>:     <span class="c"># identify intersections in a manner that is consistent with the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1251</span>:     <span class="c"># 2d and 3d method</span></pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1252</span>:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">((</span><span class="n">proj1</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proj2</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">))</span></pre>
<pre class='cython code score-35 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_proj1, __pyx_v_proj2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1252, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFloat_EqObjC</span>(__pyx_v_proj1, __pyx_float_0_0, 0.0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFloat_EqObjC</span>(__pyx_v_proj2, __pyx_float_0_0, 0.0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Invert</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_crossed_bool = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1253</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-52 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7 = 0;
      __pyx_t_8 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1253, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_8 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1253, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_8)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
          if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1253, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1253, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1253, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1253, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_8(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 1253, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1254</span>:       <span class="c"># indices of all simplices crossed for segment i</span></pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1255</span>:       <span class="n">crossed_idx</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">crossed_bool</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-87 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_nonzero);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_crossed_bool, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_9 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
          PyObject *__pyx_temp[2] = {__pyx_t_9, __pyx_t_4};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
          PyObject *__pyx_temp[2] = {__pyx_t_9, __pyx_t_4};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        {
          __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_t_4);
          __pyx_t_4 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 1)) {
          if (size &gt; 1) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(1);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 1255, __pyx_L1_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        } else {
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_11 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
        index = 0; __pyx_t_2 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_2)) goto __pyx_L9_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_11(__pyx_t_10), 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1255, __pyx_L1_error)</span>
        __pyx_t_11 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        goto __pyx_L10_unpacking_done;
        __pyx_L9_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_11 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>__PYX_ERR(0, 1255, __pyx_L1_error)</span>
        __pyx_L10_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_crossed_idx, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1256</span>:       <span class="n">proj1i</span> <span class="o">=</span> <span class="n">proj1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_i);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_idx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_idx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_crossed_idx);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_proj1, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_proj1i, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1257</span>:       <span class="n">proj2i</span> <span class="o">=</span> <span class="n">proj2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_i);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_idx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_idx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_crossed_idx);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_proj2, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_proj2i, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1258</span>:       <span class="c"># find the intersection closest to start_point i</span></pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1259</span>:       <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">proj1i</span><span class="o">/</span><span class="p">(</span><span class="n">proj1i</span><span class="o">-</span><span class="n">proj2i</span><span class="p">))</span></pre>
<pre class='cython code score-53 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_argmin);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_proj1i, __pyx_v_proj2i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_proj1i, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_10)) {
          PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_4};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_10, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_10)) {
          PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_4};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_10, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        {
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_4);
          __pyx_t_4 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_idx, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1260</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">crossed_idx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_crossed_idx, __pyx_v_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1260, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_v_i, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1260, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1261</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1262</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1262, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1262, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_index_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
    __pyx_t_3 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_index_2d(__pyx_t_12, __pyx_t_13, __pyx_t_14, __pyx_t_15));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __pyx_t_12.memview = NULL;
    __pyx_t_12.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __pyx_t_13.memview = NULL;
    __pyx_t_13.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
    __pyx_v_out = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1264</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1265</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(__pyx_t_6)) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1266</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_index_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 1266, __pyx_L1_error)</span>
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 1266, __pyx_L1_error)</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 1266, __pyx_L1_error)</span>
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 1266, __pyx_L1_error)</span>
    __pyx_t_3 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_index_3d(__pyx_t_14, __pyx_t_13, __pyx_t_12, __pyx_t_15));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1266, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __pyx_t_13.memview = NULL;
    __pyx_t_13.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __pyx_t_12.memview = NULL;
    __pyx_t_12.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
    __pyx_v_out = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1267</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1268</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1269</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  }
  __pyx_L6:;
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_intersections_can_only_be_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 1269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
</pre><pre class="cython line score-0">&#xA0;<span class="">1270</span>:       <span class="s">&#39;intersections can only be found for a 1, 2, or 3 dimensional &#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1271</span>:       <span class="s">&#39;simplicial complex&#39;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1272</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1273</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1274</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1275</span>: </pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1276</span>: <span class="k">def</span> <span class="nf">intersection_count</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-69 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_7intersection_count(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_6intersection_count[] = " \n  Returns the number of simplices crossed by the line segments. The \n  line segments are described by `start_points` and `end_points`. This \n  function works for 1, 2, and 3 spatial dimensions.\n\n  Parameters\n  ----------\n  start_points : (N,D) array\n    Vertices describing one end of the line segments. `N` is the \n    number of line segments and `D` is the number of dimensions\n\n  end_points : (N,D) array \n    Vertices describing the other end of the line segments\n\n  vertices : (M,D) array \n    Vertices within the simplicial complex. `M` is the number of \n    vertices\n\n  simplices : (P,D) array\n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n  out : (N,) int array\n    intersection counts\n\n  Notes\n  -----\n  This function is parallelized. Set the number of threads used with \n  the environment variable `OMP_NUM_THREADS`.\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_7intersection_count = {"intersection_count", (PyCFunction)__pyx_pw_3rbf_8geometry_7intersection_count, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_6intersection_count};
static PyObject *__pyx_pw_3rbf_8geometry_7intersection_count(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_count (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_count", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1276, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_count", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1276, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_count", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 1276, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersection_count") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1276, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_count", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1276, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_count", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_6intersection_count(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_6intersection_count(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_proj1 = NULL;
  PyObject *__pyx_v_proj2 = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_count", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_count", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__81 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_vert, __pyx_n_s_proj1, __pyx_n_s_proj2, __pyx_n_s_crossed_bool, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 1276, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__81);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__81);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_7intersection_count, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1276, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_intersection_count, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1276, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__82 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__81, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_intersection_count, 1276, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__82)) __PYX_ERR(0, 1276, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1277</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1278</span>: <span class="sd">  Returns the number of simplices crossed by the line segments. The </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1279</span>: <span class="sd">  line segments are described by `start_points` and `end_points`. This </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1280</span>: <span class="sd">  function works for 1, 2, and 3 spatial dimensions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1281</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1282</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1283</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1284</span>: <span class="sd">  start_points : (N,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1285</span>: <span class="sd">    Vertices describing one end of the line segments. `N` is the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1286</span>: <span class="sd">    number of line segments and `D` is the number of dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1287</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1288</span>: <span class="sd">  end_points : (N,D) array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1289</span>: <span class="sd">    Vertices describing the other end of the line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1290</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1291</span>: <span class="sd">  vertices : (M,D) array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1292</span>: <span class="sd">    Vertices within the simplicial complex. `M` is the number of </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1293</span>: <span class="sd">    vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1294</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1295</span>: <span class="sd">  simplices : (P,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1296</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1297</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1299</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1300</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1301</span>: <span class="sd">  out : (N,) int array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1302</span>: <span class="sd">    intersection counts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1303</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1304</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1305</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1306</span>: <span class="sd">  This function is parallelized. Set the number of threads used with </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1307</span>: <span class="sd">  the environment variable `OMP_NUM_THREADS`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1308</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1309</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1310</span>:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1310, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1311</span>:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1312</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1312, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1313</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1313, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1313, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1313, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1313, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1313, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1313, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1314</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1314, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1315</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__19, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1315, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 1315, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
</pre><pre class="cython line score-0">&#xA0;<span class="">1316</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1317</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1317, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = ((!__pyx_t_6) != 0);
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1318</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__20, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1318, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 1318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);
</pre><pre class="cython line score-0">&#xA0;<span class="">1319</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1320</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1321</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;start points and end points must have the same length&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1321, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_start_points_and_end_points_must);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 1321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
</pre><pre class="cython line score-0">&#xA0;<span class="">1322</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1323</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1324</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1324, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1325</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__22 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__22)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__22);
/* … */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_vert = __pyx_t_1;
    __pyx_t_1 = 0;
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__22, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1326</span>:     <span class="n">proj1</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1326, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_start_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1326, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_proj1 = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1327</span>:     <span class="n">proj2</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1327, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1327, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_proj2 = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1328</span>:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">((</span><span class="n">proj1</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proj2</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">))</span></pre>
<pre class='cython code score-35 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_proj1, __pyx_v_proj2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1328, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFloat_EqObjC</span>(__pyx_v_proj1, __pyx_float_0_0, 0.0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFloat_EqObjC</span>(__pyx_v_proj2, __pyx_float_0_0, 0.0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Invert</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_crossed_bool = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1329</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">crossed_bool</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_bool);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_bool);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_crossed_bool);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1330</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1331</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1331, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1331, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1332</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_count_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_count_2d(__pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1333</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1334</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1334, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1334, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_6)) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1335</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_count_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_count_3d(__pyx_t_9, __pyx_t_8, __pyx_t_7, __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1336</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1337</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1338</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>  /*else*/ {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__24, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1338, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1338, __pyx_L1_error)</span>
  }
  __pyx_L6:;
/* … */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_intersections_can_only_be_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 1338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
</pre><pre class="cython line score-0">&#xA0;<span class="">1339</span>:       <span class="s">&#39;intersections can only be found for a 1, 2, or 3 dimensional &#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1340</span>:       <span class="s">&#39;simplicial complex&#39;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1341</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1342</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1343</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1344</span>: </pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1345</span>: <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-64 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_9contains(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_8contains[] = " \n  Returns a boolean array identifying whether the points are contained \n  within a closed simplicial complex. The simplicial complex is \n  described by `vertices` and `simplices`. This function works for 1, \n  2, and 3 spatial dimensions.\n\n  Parameters\n  ----------\n  points : (N,D) array\n    Test points\n\n  vertices : (M,D) array\n    Vertices of the simplicial complex\n\n  simplices : (P,D) int array \n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n  out : (N,) bool array \n    Indicates which test points are in the simplicial complex\n\n  Notes\n  -----\n  This function does not ensure that the simplicial complex is\n  closed.  If it is not then bogus results will be returned. \n    \n  This function determines whether a point is contained within the\n  simplicial complex by finding the number of intersections between\n  each point and an arbitrary outside point.  It is possible,\n  although rare, that this function will fail if the line segment\n  intersects a simplex at an edge.\n\n  This function does not require any particular orientation for the \n  simplices\n\n  This function is parallelized. Set the number of threads used with \n  the environment variable `OMP_NUM_THREADS`.\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_9contains = {"contains", (PyCFunction)__pyx_pw_3rbf_8geometry_9contains, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_8contains};
static PyObject *__pyx_pw_3rbf_8geometry_9contains(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("contains", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1345, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("contains", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1345, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "contains") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1345, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_points = values[0];
    __pyx_v_vertices = values[1];
    __pyx_v_simplices = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("contains", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1345, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_8contains(__pyx_self, __pyx_v_points, __pyx_v_vertices, __pyx_v_simplices);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_8contains(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_outside_point = NULL;
  PyObject *__pyx_v_end_points = NULL;
  PyObject *__pyx_v_proj1 = NULL;
  PyObject *__pyx_v_proj2 = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_crossed_count = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outside_point);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__83 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_vert, __pyx_n_s_outside_point, __pyx_n_s_end_points, __pyx_n_s_proj1, __pyx_n_s_proj2, __pyx_n_s_crossed_bool, __pyx_n_s_crossed_count, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 1345, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__83);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__83);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_9contains, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1345, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_contains, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1345, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__84 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_contains, 1345, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__84)) __PYX_ERR(0, 1345, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1346</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1347</span>: <span class="sd">  Returns a boolean array identifying whether the points are contained </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1348</span>: <span class="sd">  within a closed simplicial complex. The simplicial complex is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1349</span>: <span class="sd">  described by `vertices` and `simplices`. This function works for 1, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1350</span>: <span class="sd">  2, and 3 spatial dimensions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1351</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1352</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1353</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1354</span>: <span class="sd">  points : (N,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1355</span>: <span class="sd">    Test points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1356</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1357</span>: <span class="sd">  vertices : (M,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1358</span>: <span class="sd">    Vertices of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1359</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1360</span>: <span class="sd">  simplices : (P,D) int array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1361</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1362</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1363</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1364</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1365</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1366</span>: <span class="sd">  out : (N,) bool array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1367</span>: <span class="sd">    Indicates which test points are in the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1368</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1369</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1370</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1371</span>: <span class="sd">  This function does not ensure that the simplicial complex is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1372</span>: <span class="sd">  closed.  If it is not then bogus results will be returned. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1373</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1374</span>: <span class="sd">  This function determines whether a point is contained within the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1375</span>: <span class="sd">  simplicial complex by finding the number of intersections between</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1376</span>: <span class="sd">  each point and an arbitrary outside point.  It is possible,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1377</span>: <span class="sd">  although rare, that this function will fail if the line segment</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1378</span>: <span class="sd">  intersects a simplex at an edge.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1379</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1380</span>: <span class="sd">  This function does not require any particular orientation for the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1381</span>: <span class="sd">  simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1382</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1383</span>: <span class="sd">  This function is parallelized. Set the number of threads used with </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1384</span>: <span class="sd">  the environment variable `OMP_NUM_THREADS`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1385</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1386</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1387</span>:   <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">points</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_points);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_points};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_points};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_points);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_points);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_points);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_points, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1388</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_vertices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1388, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_v_vertices};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1388, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_v_vertices};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1388, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1388, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_vertices);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1388, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1389</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1389, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1389, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_simplices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_simplices};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_simplices};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1389, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_simplices);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1390</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1390, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1390, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1391</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1391, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1391, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1391, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1391, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1391, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1391, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1392</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__25, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1392, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1392, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__25 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 1392, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
</pre><pre class="cython line score-0">&#xA0;<span class="">1393</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1394</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1394, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1395</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__26 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__26)) __PYX_ERR(0, 1395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__26);
/* … */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__27);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1395, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1395, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_vert = __pyx_t_3;
    __pyx_t_3 = 0;
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__26, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 1395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1396</span>:     <span class="n">outside_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span></pre>
<pre class='cython code score-27 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_vert);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1396, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFloat_SubtractObjC</span>(__pyx_t_4, __pyx_float_1_0, 1.0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_outside_point = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1397</span>:     <span class="n">end_points</span> <span class="o">=</span> <span class="n">outside_point</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_slice__28 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__28)) __PYX_ERR(0, 1397, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__28);
/* … */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_outside_point, __pyx_tuple__29);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_repeat);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1397, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_end_points = __pyx_t_2;
    __pyx_t_2 = 0;
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__28, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 1397, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1398</span>:     <span class="n">proj1</span> <span class="o">=</span> <span class="p">(</span><span class="n">points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1398, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_points, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1398, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_proj1 = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1399</span>:     <span class="n">proj2</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1399, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1399, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_proj2 = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1400</span>:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">((</span><span class="n">proj1</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proj2</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">))</span></pre>
<pre class='cython code score-35 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_proj1, __pyx_v_proj2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFloat_EqObjC</span>(__pyx_v_proj1, __pyx_float_0_0, 0.0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFloat_EqObjC</span>(__pyx_v_proj2, __pyx_float_0_0, 0.0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Invert</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_crossed_bool = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1401</span>:     <span class="n">crossed_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">crossed_bool</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1401, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1401, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1401, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_bool);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_bool);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_crossed_bool);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1401, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1401, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1401, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_crossed_count = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1402</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">crossed_count</span><span class="o">%</span><span class="mf">2</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_RemainderObjC</span>(__pyx_v_crossed_count, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject*)&amp;PyBool_Type)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1402, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1403</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1404</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1404, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1404, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1405</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">contains_2d</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1405, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1405, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1405, __pyx_L1_error)</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_contains_2d(__pyx_t_7, __pyx_t_8, __pyx_t_9));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1405, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1406</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1407</span>:   <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1407, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1407, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_6)) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1408</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">contains_3d</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_points, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1408, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1408, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1408, __pyx_L1_error)</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_contains_3d(__pyx_t_8, __pyx_t_7, __pyx_t_9));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1408, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1409</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1411</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>  /*else*/ {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__30, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1411, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1411, __pyx_L1_error)</span>
  }
  __pyx_L4:;
/* … */
  __pyx_tuple__30 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_point_in_polygon_tests_can_only);<span class='error_goto'> if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 1411, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__30);
</pre><pre class="cython line score-0">&#xA0;<span class="">1412</span>:       <span class="s">&#39;point in polygon tests can only be done for a 1, 2, or 3 &#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>:       <span class="s">&#39;dimensional simplicial complex&#39;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1414</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1415</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1416</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1417</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1418</span>: <span class="k">def</span> <span class="nf">simplex_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">):</span></pre>
<pre class='cython code score-55 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_11simplex_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_10simplex_normals[] = " \n  Returns the normal vectors for each simplex. Orientation is \n  determined by the right hand rule\n\n  Parameters\n  ----------\n  vertices : (M,D) array\n    Vertices within the simplicial complex\n\n  simplices : (P,D) int array \n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n  out : (P,D) array\n    normals vectors\n      \n  Notes\n  -----\n  This is only defined for two and three dimensional simplices\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_11simplex_normals = {"simplex_normals", (PyCFunction)__pyx_pw_3rbf_8geometry_11simplex_normals, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_10simplex_normals};
static PyObject *__pyx_pw_3rbf_8geometry_11simplex_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_normals (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_normals", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1418, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simplex_normals") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1418, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_normals", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1418, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_10simplex_normals(__pyx_self, __pyx_v_vert, __pyx_v_smp);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_10simplex_normals(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_M = NULL;
  PyObject *__pyx_v_Msubs = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_normals", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_M);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Msubs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__85 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_dim, __pyx_n_s_M, __pyx_n_s_Msubs, __pyx_n_s_out, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 1418, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__85);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__85);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_11simplex_normals, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1418, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_simplex_normals, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1418, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__86 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__85, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_simplex_normals, 1418, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__86)) __PYX_ERR(0, 1418, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1419</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>: <span class="sd">  Returns the normal vectors for each simplex. Orientation is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1421</span>: <span class="sd">  determined by the right hand rule</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1422</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1423</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1424</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1425</span>: <span class="sd">  vertices : (M,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1426</span>: <span class="sd">    Vertices within the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1427</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1428</span>: <span class="sd">  simplices : (P,D) int array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1429</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1430</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1431</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1432</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1433</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1434</span>: <span class="sd">  out : (P,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1435</span>: <span class="sd">    normals vectors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1436</span>: <span class="sd">      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1437</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1438</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1439</span>: <span class="sd">  This is only defined for two and three dimensional simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1440</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1441</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1442</span>:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1443</span>:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1443, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1443, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1443, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1443, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1443, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1443, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1444</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1445</span>:   <span class="c"># spatial dimensions        </span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1446</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1447</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1448</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1448, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1448, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1448, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1448, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1449</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;simplicial complex must be 2 or 3 dimensional&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__31, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1449, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1449, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_simplicial_complex_must_be_2_or);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 1449, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
</pre><pre class="cython line score-0">&#xA0;<span class="">1450</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1451</span>:   <span class="c"># I `could` find the normal vectors for each simplex by converting </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1452</span>:   <span class="c"># the vertices and simplices to segment and triangle C structures </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1453</span>:   <span class="c"># and then use the `segment_normal_2d` and `triangle_normal_3d` C </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1454</span>:   <span class="c"># functions. However, I will compute the normals directly from the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1455</span>:   <span class="c"># numpy arrays. This is all vectorized so it should not be any </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1456</span>:   <span class="c"># slower than using the C functions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1458</span>:   <span class="c"># Create a N by D-1 by D matrix    </span></pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1459</span>:   <span class="n">M</span> <span class="o">=</span> <span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">[:,</span><span class="mf">1</span><span class="p">:]]</span> <span class="o">-</span> <span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">[:,[</span><span class="mf">0</span><span class="p">]]]</span></pre>
<pre class='cython code score-53 '>  __pyx_slice__32 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__32)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__32);
  __pyx_slice__33 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__33)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__33);
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_smp, __pyx_tuple__34);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vert, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__32, __pyx_slice__33);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__35);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_smp, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vert, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_M = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_slice__35 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__35)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__35);
</pre><pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1460</span>:   <span class="n">Msubs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span></pre>
<pre class='cython code score-98 '>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_dim);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_delete);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_9 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_8)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_M, __pyx_v_i, __pyx_int_neg_1};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_8)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_M, __pyx_v_i, __pyx_int_neg_1};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (__pyx_t_3) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_M);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_M);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, __pyx_v_M);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, __pyx_v_i);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2+__pyx_t_9, __pyx_int_neg_1);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_4, (PyObject*)__pyx_t_1))) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_Msubs = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1461</span>:   <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">Msubs</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1461, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1461, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_det);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1461, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_Msubs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1461, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_v_Msubs};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1461, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_v_Msubs};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1461, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else
    #endif
    {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1461, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_1); __pyx_t_1 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Msubs);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Msubs);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_v_Msubs);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1461, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_out = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1462</span>:   <span class="n">out</span><span class="p">[</span><span class="mf">1</span><span class="p">::</span><span class="mf">2</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-21 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__36);
  __pyx_t_11 = __pyx_slice__36;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_out, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_4, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_t_11, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1462, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_slice__36 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_slice__36)) __PYX_ERR(0, 1462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__36);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__36);
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1463</span>:   <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1463, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_rollaxis);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1463, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_9 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_9 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_out, __pyx_int_neg_1};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1463, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_out, __pyx_int_neg_1};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1463, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else
  #endif
  {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1463, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_out);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_9, __pyx_v_out);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_9, __pyx_int_neg_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1463, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_out, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1464</span>:   <span class="n">out</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mf">1</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span></pre>
<pre class='cython code score-39 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_norm);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_out);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_out);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_axis, __pyx_int_neg_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1464, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_4, __pyx_tuple__37);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_InPlaceDivide</span>(__pyx_v_out, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_out, __pyx_t_4);
  __pyx_t_4 = 0;
/* … */
  __pyx_tuple__37 = <span class='py_c_api'>PyTuple_Pack</span>(2, Py_Ellipsis, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__37);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1465</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1466</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1467</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1468</span>: <span class="k">def</span> <span class="nf">simplex_outward_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">):</span></pre>
<pre class='cython code score-48 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_13simplex_outward_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_12simplex_outward_normals[] = " \n  Returns the outward normal vectors for each simplex. The sign of the \n  returned vectors are only meaningful if the simplices enclose an \n  area in two-dimensional space or a volume in three-dimensional space\n\n  Parameters\n  ----------\n  vertices : (M,D) array\n    Vertices within the simplicial complex\n\n  simplices : (P,D) int array \n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n  out : (P,D) array\n    normals vectors\n      \n  Notes\n  -----\n  This is only defined for two and three dimensional simplices\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_13simplex_outward_normals = {"simplex_outward_normals", (PyCFunction)__pyx_pw_3rbf_8geometry_13simplex_outward_normals, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_12simplex_outward_normals};
static PyObject *__pyx_pw_3rbf_8geometry_13simplex_outward_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_outward_normals (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_outward_normals", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simplex_outward_normals") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_outward_normals", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_outward_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_12simplex_outward_normals(__pyx_self, __pyx_v_vert, __pyx_v_smp);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_12simplex_outward_normals(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_outward_normals", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_outward_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__87 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_dim);<span class='error_goto'> if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 1468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__87);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__87);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_13simplex_outward_normals, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_simplex_outward_normals, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__88 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__87, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_simplex_outward_normals, 1468, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__88)) __PYX_ERR(0, 1468, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1469</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1470</span>: <span class="sd">  Returns the outward normal vectors for each simplex. The sign of the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1471</span>: <span class="sd">  returned vectors are only meaningful if the simplices enclose an </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1472</span>: <span class="sd">  area in two-dimensional space or a volume in three-dimensional space</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1473</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1474</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1475</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1476</span>: <span class="sd">  vertices : (M,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1477</span>: <span class="sd">    Vertices within the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1478</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1479</span>: <span class="sd">  simplices : (P,D) int array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1480</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1481</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1482</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1483</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1484</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1485</span>: <span class="sd">  out : (P,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1486</span>: <span class="sd">    normals vectors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1487</span>: <span class="sd">      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1488</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1489</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1490</span>: <span class="sd">  This is only defined for two and three dimensional simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1491</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1492</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1493</span>:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1493, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1494</span>:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1495</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1496</span>:   <span class="c"># spatial dimensions        </span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1497</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1497, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1497, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1498</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1499</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1499, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1499, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1499, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1499, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1500</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;simplicial complex must be 2 or 3 dimensional&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__38, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1500, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1500, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__38 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_simplicial_complex_must_be_2_or);<span class='error_goto'> if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 1500, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__38);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__38);
</pre><pre class="cython line score-0">&#xA0;<span class="">1501</span>: </pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1502</span>:   <span class="n">smp</span> <span class="o">=</span> <span class="n">oriented_simplices</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_oriented_simplices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (__pyx_t_1) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_6, __pyx_v_vert);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_6, __pyx_v_smp);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1503</span>:   <span class="k">return</span> <span class="n">simplex_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_simplex_normals);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1503, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1503, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1503, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_6, __pyx_v_vert);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_6, __pyx_v_smp);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1503, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1504</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1505</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1506</span>: <span class="k">def</span> <span class="nf">simplex_upward_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">):</span></pre>
<pre class='cython code score-49 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_15simplex_upward_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_14simplex_upward_normals[] = " \n  Returns the upward pointing normal vectors for each simplex. The up \n  direction is assumed to be the last coordinate axis.\n\n  Parameters\n  ----------\n  vertices : (M,D) array\n    Vertices within the simplicial complex\n\n  simplices : (P,D) int array \n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n  out : (P,D) array\n    normals vectors\n      \n  Notes\n  -----\n  This is only defined for two and three dimensional simplices\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_15simplex_upward_normals = {"simplex_upward_normals", (PyCFunction)__pyx_pw_3rbf_8geometry_15simplex_upward_normals, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_14simplex_upward_normals};
static PyObject *__pyx_pw_3rbf_8geometry_15simplex_upward_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_upward_normals (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_upward_normals", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1506, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simplex_upward_normals") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1506, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_upward_normals", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1506, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_upward_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_14simplex_upward_normals(__pyx_self, __pyx_v_vert, __pyx_v_smp);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_14simplex_upward_normals(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_upward_normals", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_upward_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__89 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_dim, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__89)) __PYX_ERR(0, 1506, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__89);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__89);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_15simplex_upward_normals, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1506, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_simplex_upward_normals, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1506, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__90 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__89, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_simplex_upward_normals, 1506, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__90)) __PYX_ERR(0, 1506, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1507</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1508</span>: <span class="sd">  Returns the upward pointing normal vectors for each simplex. The up </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1509</span>: <span class="sd">  direction is assumed to be the last coordinate axis.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1510</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1511</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1512</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1513</span>: <span class="sd">  vertices : (M,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1514</span>: <span class="sd">    Vertices within the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1515</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1516</span>: <span class="sd">  simplices : (P,D) int array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1517</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1518</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1519</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1520</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1521</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1522</span>: <span class="sd">  out : (P,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1523</span>: <span class="sd">    normals vectors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1524</span>: <span class="sd">      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1525</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1526</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1527</span>: <span class="sd">  This is only defined for two and three dimensional simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1528</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1529</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1530</span>:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1530, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1531</span>:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1531, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1532</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1533</span>:   <span class="c"># spatial dimensions        </span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1534</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1535</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1536</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1536, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1537</span>:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;simplicial complex must be 2 or 3 dimensional&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__39, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1537, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1537, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__39 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_simplicial_complex_must_be_2_or);<span class='error_goto'> if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1537, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__39);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__39);
</pre><pre class="cython line score-0">&#xA0;<span class="">1538</span>: </pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1539</span>:   <span class="n">out</span> <span class="o">=</span> <span class="n">simplex_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_simplex_normals);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1539, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1539, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1539, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1539, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (__pyx_t_1) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_6, __pyx_v_vert);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_6, __pyx_v_smp);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1539, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_out = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1540</span>:   <span class="n">out</span><span class="p">[</span><span class="n">out</span><span class="p">[:,</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-33 '>  __pyx_slice__40 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__40)) __PYX_ERR(0, 1540, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__40);
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_out, __pyx_tuple__41);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1540, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_int_0, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1540, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_out, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1540, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_4, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1540, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_t_2, __pyx_t_3) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1540, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__41 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__40, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1540, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__41);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__41);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1541</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1542</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1543</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1544</span>: <span class="k">def</span> <span class="nf">oriented_simplices</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">):</span></pre>
<pre class='cython code score-55 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_17oriented_simplices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_16oriented_simplices[] = " \n  Returns simplex indices that are ordered such that each simplex \n  normal vector, as defined by the right hand rule, points outward\n                                    \n  Parameters\n  ----------\n  vertices : (M,D) array\n    Vertices within the simplicial complex\n\n  simplices : (P,D) int array \n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n  out : (P,D) int array\n    oriented simplices\n\n  Notes                                \n  -----                        \n  If one dimensional simplices are given, then the simplices are\n  returned unaltered.\n\n  This function does not ensure that the simplicial complex is\n  closed.  If it is not then bogus results will be returned. \n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_17oriented_simplices = {"oriented_simplices", (PyCFunction)__pyx_pw_3rbf_8geometry_17oriented_simplices, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_16oriented_simplices};
static PyObject *__pyx_pw_3rbf_8geometry_17oriented_simplices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("oriented_simplices (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("oriented_simplices", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1544, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "oriented_simplices") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1544, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("oriented_simplices", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1544, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.oriented_simplices", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_16oriented_simplices(__pyx_self, __pyx_v_vert, __pyx_v_smp);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_16oriented_simplices(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_scale = NULL;
  PyObject *__pyx_v_dx = NULL;
  PyObject *__pyx_v_norms = NULL;
  PyObject *__pyx_v_points = NULL;
  PyObject *__pyx_v_faces_inside = NULL;
  PyObject *__pyx_v_flip_smp = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("oriented_simplices", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.oriented_simplices", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_scale);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_norms);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_faces_inside);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flip_smp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__91 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_dim, __pyx_n_s_scale, __pyx_n_s_dx, __pyx_n_s_norms, __pyx_n_s_points, __pyx_n_s_faces_inside, __pyx_n_s_flip_smp);<span class='error_goto'> if (unlikely(!__pyx_tuple__91)) __PYX_ERR(0, 1544, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__91);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__91);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_17oriented_simplices, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1544, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_oriented_simplices, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1544, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__92 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_oriented_simplices, 1544, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__92)) __PYX_ERR(0, 1544, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1545</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1546</span>: <span class="sd">  Returns simplex indices that are ordered such that each simplex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1547</span>: <span class="sd">  normal vector, as defined by the right hand rule, points outward</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1548</span>: <span class="sd">                                    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1549</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1550</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1551</span>: <span class="sd">  vertices : (M,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1552</span>: <span class="sd">    Vertices within the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1553</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1554</span>: <span class="sd">  simplices : (P,D) int array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1555</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1556</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1557</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1558</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1559</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1560</span>: <span class="sd">  out : (P,D) int array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1561</span>: <span class="sd">    oriented simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1562</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1563</span>: <span class="sd">  Notes                                </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1564</span>: <span class="sd">  -----                        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1565</span>: <span class="sd">  If one dimensional simplices are given, then the simplices are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1566</span>: <span class="sd">  returned unaltered.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1567</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1568</span>: <span class="sd">  This function does not ensure that the simplicial complex is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1569</span>: <span class="sd">  closed.  If it is not then bogus results will be returned. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1570</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1571</span>:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1571, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1572</span>:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1572, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_copy, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1572, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1573</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1574</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1575</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1576</span>:   <span class="c"># if 1D then return smp</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1577</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1577, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1578</span>:     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_smp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_smp};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_smp};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else
      #endif
      {
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_smp);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1579</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1580</span>:   <span class="c"># length scale of the domain</span></pre>
<pre class="cython line score-91" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1581</span>:   <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span></pre>
<pre class='cython code score-91 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_vert);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_vert};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_vert};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_vert);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_vert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_vert};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_vert};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else
    #endif
    {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_vert);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_scale = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1582</span>:   <span class="n">dx</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="o">*</span><span class="n">scale</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_1eneg_10, __pyx_v_scale);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_dx = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1583</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1584</span>:   <span class="c"># find the normal for each simplex    </span></pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1585</span>:   <span class="n">norms</span> <span class="o">=</span> <span class="n">simplex_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_simplex_normals);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1585, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1585, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1585, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_1) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_7, __pyx_v_vert);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_7, __pyx_v_smp);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1585, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_norms = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1586</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1587</span>:   <span class="c"># find the centroid for each simplex      </span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1588</span>:   <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_smp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_points = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1589</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1590</span>:   <span class="c"># push points in the direction of the normals  </span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1591</span>:   <span class="n">points</span> <span class="o">+=</span> <span class="n">dx</span><span class="o">*</span><span class="n">norms</span></pre>
<pre class='cython code score-12 '>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dx, __pyx_v_norms);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1591, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1591, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1592</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1593</span>:   <span class="c"># find which simplices are oriented such that their normals point  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1594</span>:   <span class="c"># inside                           </span></pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1595</span>:   <span class="n">faces_inside</span> <span class="o">=</span> <span class="n">contains</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-41 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_contains);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_7 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_v_points, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1595, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_v_points, __pyx_v_vert, __pyx_v_smp};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1595, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else
  #endif
  {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (__pyx_t_6) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_7, __pyx_v_points);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_7, __pyx_v_vert);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_7, __pyx_v_smp);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_faces_inside = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1596</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1597</span>:   <span class="n">flip_smp</span> <span class="o">=</span> <span class="n">smp</span><span class="p">[</span><span class="n">faces_inside</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_smp, __pyx_v_faces_inside);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_flip_smp = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1598</span>:   <span class="n">flip_smp</span><span class="p">[:,[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">flip_smp</span><span class="p">[:,[</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-54 '>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__42);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__42);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__42);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_flip_smp, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__42 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__42)) __PYX_ERR(0, 1598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__42);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__42);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__43);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__43);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_slice__43);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_flip_smp, __pyx_t_3, __pyx_t_4) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1598, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_slice__43 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__43)) __PYX_ERR(0, 1598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__43);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__43);
</pre><pre class="cython line score-0">&#xA0;<span class="">1599</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1600</span>:   <span class="n">smp</span><span class="p">[</span><span class="n">faces_inside</span><span class="p">]</span> <span class="o">=</span> <span class="n">flip_smp</span></pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_smp, __pyx_v_faces_inside, __pyx_v_flip_smp) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1600, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1601</span>:   <span class="k">return</span> <span class="n">smp</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  __pyx_r = __pyx_v_smp;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1602</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1603</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1604</span>: <span class="k">def</span> <span class="nf">enclosure</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_19enclosure(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_18enclosure[] = " \n  Returns the volume of a polyhedra, area of a polygon, or length of\n  a segment enclosed by the simplicial complex\n\n  Parameters\n  ----------\n  vertices : (M,D) array\n    Vertices within the simplicial complex\n\n  simplices : (P,D) int array \n    Connectivity of the vertices. Each row contains the vertex \n    indices which form one simplex of the simplicial complex\n\n  orient : bool, optional\n    If true, the simplices are reordered with oriented_simplices. \n    The time for this function increase quadratically with the \n    number of simplices. Set to false if you are confident that the \n    simplices are properly oriented. This does nothing for \n    one-dimensional simplices\n\n  Returns\n  -------\n  out : float\n     \n  Notes\n  -----\n  This function does not ensure that the simplicial complex is \n  closed and does not intersect itself. If it is not then bogus \n  results will be returned.\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_19enclosure = {"enclosure", (PyCFunction)__pyx_pw_3rbf_8geometry_19enclosure, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_18enclosure};
static PyObject *__pyx_pw_3rbf_8geometry_19enclosure(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_v_orient = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("enclosure (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,&amp;__pyx_n_s_orient,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)Py_True);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("enclosure", 0, 2, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_orient);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "enclosure") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
    __pyx_v_orient = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("enclosure", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.enclosure", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_18enclosure(__pyx_self, __pyx_v_vert, __pyx_v_smp, __pyx_v_orient);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_18enclosure(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp, PyObject *__pyx_v_orient) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_signed_volumes = NULL;
  PyObject *__pyx_v_volume = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("enclosure", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.enclosure", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_signed_volumes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_volume);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__93 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_orient, __pyx_n_s_dim, __pyx_n_s_signed_volumes, __pyx_n_s_volume);<span class='error_goto'> if (unlikely(!__pyx_tuple__93)) __PYX_ERR(0, 1604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__93);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__93);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_19enclosure, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_enclosure, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__94 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__93, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_rbf_geometry_pyx, __pyx_n_s_enclosure, 1604, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__94)) __PYX_ERR(0, 1604, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1605</span>:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1606</span>: <span class="sd">  Returns the volume of a polyhedra, area of a polygon, or length of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1607</span>: <span class="sd">  a segment enclosed by the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1608</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1609</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1610</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1611</span>: <span class="sd">  vertices : (M,D) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1612</span>: <span class="sd">    Vertices within the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1613</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1614</span>: <span class="sd">  simplices : (P,D) int array </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1615</span>: <span class="sd">    Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1616</span>: <span class="sd">    indices which form one simplex of the simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1617</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1618</span>: <span class="sd">  orient : bool, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1619</span>: <span class="sd">    If true, the simplices are reordered with oriented_simplices. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1620</span>: <span class="sd">    The time for this function increase quadratically with the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1621</span>: <span class="sd">    number of simplices. Set to false if you are confident that the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1622</span>: <span class="sd">    simplices are properly oriented. This does nothing for </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1623</span>: <span class="sd">    one-dimensional simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1624</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1625</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1626</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1627</span>: <span class="sd">  out : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1628</span>: <span class="sd">     </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1629</span>: <span class="sd">  Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1630</span>: <span class="sd">  -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1631</span>: <span class="sd">  This function does not ensure that the simplicial complex is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1632</span>: <span class="sd">  closed and does not intersect itself. If it is not then bogus </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1633</span>: <span class="sd">  results will be returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1634</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1635</span>:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1635, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_copy, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1635, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1636</span>:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1636, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1637</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_smp, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1637, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1637, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1638</span>:   <span class="k">if</span> <span class="n">orient</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_orient); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1638, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1639</span>:     <span class="n">smp</span> <span class="o">=</span> <span class="n">oriented_simplices</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_oriented_simplices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1639, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_vert, __pyx_v_smp};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1639, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_vert, __pyx_v_smp};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1639, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (__pyx_t_4) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_6, __pyx_v_vert);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_6, __pyx_v_smp);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1640</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1641</span>:   <span class="c"># If 1D vertices and simplices are given then sort the vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1642</span>:   <span class="c"># and sum the length between alternating pairs of vertices</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1643</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1643, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1643, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1644</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span></pre>
<pre class='cython code score-66 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sort);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_smp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[2] = {__pyx_t_7, __pyx_t_2};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[2] = {__pyx_t_7, __pyx_t_2};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      } else
      #endif
      {
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1644, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1645</span>:     <span class="n">vert</span><span class="p">[::</span><span class="mf">2</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-21 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__44);
    __pyx_t_8 = __pyx_slice__44;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vert, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1645, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1645, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_vert, __pyx_t_8, __pyx_t_3) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1645, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
  __pyx_slice__44 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_slice__44)) __PYX_ERR(0, 1645, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__44);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__44);
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1646</span>:     <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vert</span><span class="p">))</span></pre>
<pre class='cython code score-46 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_vert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1646, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_v_vert};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1646, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_v_vert};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1646, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      } else
      #endif
      {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1646, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_vert);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1646, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Absolute</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1647</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1648</span>:   <span class="c"># center the vertices for the purpose of numerical stability</span></pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1649</span>:   <span class="n">vert</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1649, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1649, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1649, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_vert);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1649, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1649, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1649, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_v_vert, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1649, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1650</span>:   <span class="n">signed_volumes</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">])</span></pre>
<pre class='cython code score-98 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_factorial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_dim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_dim};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_dim};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dim);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dim);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_dim);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideCObj</span>(__pyx_float_1_0, __pyx_t_2, 1.0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_det);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_smp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_7, __pyx_t_4};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_7, __pyx_t_4};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    {
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1650, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_signed_volumes = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1651</span>:   <span class="n">volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">signed_volumes</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1651, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1651, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_signed_volumes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_signed_volumes};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1651, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_signed_volumes};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1651, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else
    #endif
    {
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1651, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_signed_volumes);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_signed_volumes);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_signed_volumes);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1651, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_volume = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1652</span>:   <span class="k">return</span> <span class="n">volume</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_volume);
  __pyx_r = __pyx_v_volume;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1653</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1654</span>: </pre>
</div></body></html>
